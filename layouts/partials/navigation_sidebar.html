<!-- Navigation Sidebar Content
     --------------------------
  Anything that shows up in the left bar of any webpage should be added here.

  This partial should be invoked with a dict containing the below members
    "context"    -- The Context in which the partial was invoked
    "menu_title" -- The name of the Hugo menu to render, "" if nothing.
-->
<aside id="nav-container" role="complementary">
  <nav class="overview" id="primary-nav" role="nav">
    <div id="primary-nav-content">
      <h2 class="responsive-link"><a class="responsive-toggle"></a></h2>

      <!-- Search bar -->
      <form id="searchbox_011972015458788978446:zgdcy4fa-o0" action="">
        <div class="nav-field-container">
          <div id="icon-container-search">
            <div class="icon-container"><span aria-hidden="true" class="nav-icon-search icon-search"></span></div>
            <span class="separator">&#124;</span>
          </div>
          <input id="main-search" name="q" placeholder="Search" size="5" type="search">
        </div>
      </form>

      <div class="clear"></div>

      <!-- Vist Basho link, only displayed in reduced-width -->
      <h3 class="responsive-link visit-basho">
        <a href="http://www.basho.com">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">Visit Basho</span>
          <div class="clear"></div>
        </a>
      </h3>

      <!-- All Projects (splash) link, only displayed in reduced-width -->
      <h3 class="responsive-link">
        <a href="/index.html">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">All Riak Projects</span>
          <div class="clear"></div>
        </a>
      </h3>

      <!-- Dynamic Navigation Sidebar Entries
        One entry per page in the project.
      {{ $current_node := $.context }}
      -->
      <!--FIXME: The below structure + CSS (and maybe JS?) are absolute trash.
                 I completely disagree with the existence of the menu-toggle
                 element being predicated on the h4 element. This all just
                 makes me so sad. -->
      {{ range $current_menu := (index $.context.Site.Menus $.menu_title) }}
        <h3>
          <span class="icon-container"><span aria-hidden="true" class="nav-icon {{ .Pre }}"></span>&nbsp;</span>
          <span class="separator">&#124;</span>
          <span class="menu-title"><a href="{{.URL}}">{{ .Name }}</a></span>
          {{if $current_menu.HasChildren}}<span class="menu-toggle{{if or ($current_node.IsMenuCurrent $.menu_title $current_menu) ($current_node.HasMenuCurrent $.menu_title $current_menu) }} open{{end}}"></span>{{end}}
          <div class="clear"></div>
        </h3>
        {{ if $current_menu.HasChildren }}
          {{ partial "navigation_sidebar_submenu.html" (dict "current_menu" $current_menu "current_node" $current_node "menu_title" $.menu_title "menu_depth" 1) }}
      {{ end }} {{ end }}
      <!-- /Dynamic Navigation Sidebar Entries -->
      <!-- Community Navigation Item/
        This item should always be present.
      -->
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-comments"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/community">Community</a></span>
        <div class="clear"></div>
      </h3>
      <!-- This empty <ul> marks the end of the generated nav list -->
      <!--TODO: Figure out why this is, and do it better. -->
      <ul></ul>
    </div>
  </nav>

  <!-- Fixed Nav Content
    The fixed-nav will be locked to the bottom of the navigation container.
  -->
  <!--TODO: Come up with a better name than "fixed-nav" -->
  <ul id="fixed-nav">
    <li>
      <a href="https://github.com/basho/basho_docs" target="_blank">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xe004;"></span>
        </div>
        <span class="separator">&#124;</span>Available on GitHub
      </a>
    </li>
    <li>
      <a href="/riak/latest/community/">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xf059;"></span>
        </div>
        <span class="separator">&#124;</span>Get Help
      </a>
    </li>
  </ul>
  <!-- /fixed-nav -->
</aside>
