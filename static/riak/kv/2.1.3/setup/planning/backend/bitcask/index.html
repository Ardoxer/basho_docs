<!DOCTYPE html>

<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"></html><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"></html><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"></html><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->




<head class="tutorials">
  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <meta name="project" content="riak_kv">
  <meta name="version" content="2.1.3">
  <meta name="base-url" content="">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <title>Bitcask</title>

  <link href="/css/all.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/css/print.css" media="print" rel="stylesheet" type="text/css">

  
  <style type="text/css"> .js_enabled pre { visibility : hidden; } </style>
  <script type="text/javascript">
    document.documentElement.className = 'js_enabled';
  </script>
</head>



<body class="riak_kv 2.1.3 latest ">

  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>

  
<aside id="nav-container" role="complementary">
  <nav class="overview" id="primary-nav" role="nav">
    <div id="primary-nav-content">
      <h2 class="responsive-link"><a class="responsive-toggle"></a></h2>

      
      <form id="searchbox_011972015458788978446:zgdcy4fa-o0" action="">
        <div class="nav-field-container">
          <div id="icon-container-search">
            <div class="icon-container"><span aria-hidden="true" class="nav-icon-search icon-search"></span></div>
            <span class="separator">&#124;</span>
          </div>
          <input id="main-search" name="q" placeholder="Search" size="5" type="search" />
        </div>
      </form>

      <div class="clear"></div>

      
      <h3 class="responsive-link visit-basho">
        <a href="http://www.basho.com">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">Visit Basho</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      <h3 class="responsive-link">
        <a href="/index.html">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">All Riak Projects</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-riak"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/">Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-download-alt"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/downloads/">Download Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-install"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/setup/">Setup</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/">Planning</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/start/">Start Planning</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/operating-system/">OS Support</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/backend/">Choosing a Backend</a></span></h4>
    
<ul class="depth-3">
  
  <li class="current">
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/bitcask/">Bitcask</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/leveldb/">LevelDB</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/memory/">Memory</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/multi/">Multi-backend</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/cluster-capacity/">Cluster Capacity</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/bitcask-capacity-calc/">Bitcask Capacity Calculator</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/future/">Planning for the Future</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/">Installing</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/amazon-web-services/">Amazon Web Services</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/debian-ubuntu/">Debian &amp; Ubuntu</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/freebsd/">FreeBSD</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/mac-osx/">Mac OS X</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/rhel-centos/">RHEL &amp; CentOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/smartos/">SmartOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/solaris/">Solaris</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/suse/">SUSE</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/windows-azure/">Windows Azure</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/source/">Installing From Source</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/erlang/">Installing Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/jvm/">Installing the JVM</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/verify/">Verifying an Installation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/upgrading/">Upgrading</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/checklist/">Production Checklist</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/version/">Upgrading by Version</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/cluster/">Upgrading a Cluster</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/multi-datacenter/">Upgrading Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/downgrade/">Downgrading</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-cog"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/configuring/">Configuring</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/basic/">Basic Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/backend/">Backend Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/managing/">Managing Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/reference/">Configuration Reference</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/strong-consistency/">Implementing Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/load-balancing-proxy/">Load Balancing &amp; Proxy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/mapreduce/">MapReduce Settings</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/search/">Search Settings</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/">V3 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/">V2 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-database"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/using/">Using</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/running-a-cluster/">Running a Cluster</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/admin/">Cluster Administration</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/commands/">Cluster Admin Commands</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-admin/">riak-admin CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-cli/">riak CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-control/">Riak Control</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/cluster-operations/">Cluster Operations</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/adding-removing-nodes/">Adding/Removing Nodes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/changing-cluster-info/">Changing Cluster Information</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/replacing-node/">Replacing a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/inspecting-node/">Inspecting a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backing-up/">Backing Up</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/secondary-indexes/">Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/monitoring-strong-consistency/">Monitoring Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/load-balancing/">Load Balancing</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backend/">Backend</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v3-multi-datacenter/">V3 Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v2-multi-datacenter/">V2 Multi-Datacenter</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/repair-recovery/">Repair &amp; Recovery</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/errors/">Errors</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/repairs/">Repairs</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/rolling-restart/">Rolling Restarts</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/security/">Security</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/basics/">Security Basics</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/managing-sources/">Managing Security Sources</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/v2-v3-ssl-ca/">V2/V3 SSL &amp; CA Validation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/performance/">Performance</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/benchmarking/">Benchmarking</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/open-files-limit/">Open Files Limit</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/v2-scheduling-fullsync/">V2 Scheduling Fullsync</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/multi-datacenter-tuning/">Multi-Datacenter Replication</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/">Troubleshooting</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/">Product Advisories</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/210-dataloss/">Default Configuration For Handoff May Cause Data Loss</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/appconfig-foward/">Forward Incompatibility of app.config</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/dvv-lastwritewins/">Incompatibility between Dotted Version Vectors and Last Write Wins</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/maps-204/">Map Data Type Disk Incompatibility</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/ssl-poodle/">SSL 3.0 Vulnerability and POODLE Attack</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/http-204/">HTTP 204</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/reference/">Reference</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/runtime-interaction/">Runtime Interaction</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/monitoring/">Monitoring</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/search-secondary-indexes/">Search &amp; Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/multi-datacenter/">Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v3/">V3 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v2/">V2 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/architecture/">Architecture</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-lambda"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/developing/">Developing</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/">Getting Started</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/java/">Java</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/ruby/">Ruby</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/python/">Python</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/csharp/">C Sharp</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/nodejs/">NodeJS</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/erlang/">Erlang</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/golang/">Go</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/php/">PHP</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/querying/">Querying</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/">Usage</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/creating-objects/">Creating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/reading-objects/">Reading Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/updating-objects/">Updating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/deleting-objects/">Deleting Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/content-types/">Content Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search/">Searching</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/mapreduce/">Using MapReduce</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/secondary-indexes/">Using Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/commit-hooks/">Using Commit Hooks</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search-schemas/">Creating Search Schemas</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/searching-data-types/">Searching with Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/document-store/">Implementing a Document Store</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/custom-extractors/">Custom Extractors</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/security/">Security</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/erlang/">Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/php/">PHP</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/replication/">Replication</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/">Conflict Resolution</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/csharp/">C Sharp</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/nodejs/">NodeJS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/php/">PHP</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/golang/">Go</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-types/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-modeling/">Data Modeling</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/app-guide/">Application Guide</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/replication-properties/">Replication Properties</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/write-once/">Write Once</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/reference/">Reference</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/client-libraries/">Client Libraries</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/api/">APIs</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/repl-hooks/">V2 Multi-Datacenter REPL Hooks API</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/backend/">Backend API</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/faq/">Developing FAQ</a>
  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-beaker"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/learn/">Learning</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/why-riak-kv/">Why Riak KV?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/use-cases/">Use Cases</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/new-to-nosql/">New to NoSQL?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/glossary/">Riak KV Glossary</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/learn/concepts/">Concepts</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/active-anti-entropy/">Active Anti-Entropy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/buckets/">Buckets</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/capability-negotiation/">Capability Negotiation</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/causal-context/">Causal Context</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/clusters/">Clusters</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/crdts/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/eventual-consistency/">Eventual Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/keys-and-objects/">Keys and Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/replication/">Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/vnodes/">Vnodes</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-comments"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/community">Community</a></span>
        <div class="clear"></div>
      </h3>
      <ul></ul> 
    </div>
  </nav>

  
  <ul id="fixed-nav">
    <li>
      <a href="https://github.com/basho/basho_docs" target="_blank">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xe004;"></span>
        </div>
        <span class="separator">&#124;</span>Available on GitHub
      </a>
    </li>
    <li>
      <a href="/riak/latest/community/">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xf059;"></span>
        </div>
        <span class="separator">&#124;</span>Get Help
      </a>
    </li>
  </ul>
</aside>


  <script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>


  <div role="main">

    <header class="masthead">
  <div id="header">
    
    <div id="header-inner">
      <div class="icon-reorder" id="nav-toggle"></div>

      <div id="top-nav">
        
        <a href="/riak/kv/2.1.3/downloads/"><span class="icon-download-alt"></span>Downloads</a>
        <div id="nav-more"><span class="icon-more"></span></div>
      </div>

      <a class="responsive-toggle"></a>
      
      
      <a class="logo" href="/index.html"><h1>Riak Docs</h1></a>
      
      <span class="tagline">Product tutorials, how-tos, and fully-documented APIs.</span>
      <div id="nav-menu">
        <h2>Links</h2>
        <ul>
          <li><a href="http://docs.basho.com/">Docs Home</a></li>
          <li><a href="http://basho.com/">Basho Website</a></li>
        </ul>
        
        <div id="nav-menu-arrow"></div>
        <div id="nav-menu-arrow-back"></div>
      </div>

      <div class="clear"></div>

      <div class="header-rule"></div>
    </div>
  </div>
</header>


    <article class="mainarticle">

      <div class="versions">
  <div id="version-ddown-button" class="unselected">
    <div class="version-ddown-title">Version</div>
    <div class="version-ddown-number">2.1.3</div>
    <div class="version-ddown-arrow"></div>
  </div>
  <ol id="version-list" style="display: none;">
  
  
    
    
      
      
      <li class="sans versions-0 current">DEV</li>
      
      <li class="current versions-0"><a class="versioned" href="/riak/kv/2.1.3/setup/planning/backend/bitcask/">2.1.3</a></li>
    
    
      
      
      
      <li class=" versions-0 first"><a class="versioned" href="/riak/kv/2.1.1/setup/planning/backend/bitcask/">2.1.1</a></li>
    
  
    
    
      
      
      
      <li class="sans versions-1 current">LTS</li>
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.6/setup/planning/backend/bitcask/">2.0.6</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.5/setup/planning/backend/bitcask/">2.0.5</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.4/setup/planning/backend/bitcask/">2.0.4</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.2/setup/planning/backend/bitcask/">2.0.2</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.1/setup/planning/backend/bitcask/">2.0.1</a></li>
    
    
      
      
      
      <li class=" versions-1 first"><a class="versioned" href="/riak/kv/2.0.0/setup/planning/backend/bitcask/">2.0.0</a></li>
    
  
  
  <li class="versions-5 first"><a class="sans versioned" href="http://docs.basho.com/riak/1.4.12/">older</a></li>
  </ol>
</div>


      
      

      <header><h1>Bitcask</h1></header>

      

      
      <nav id="toc">
        <h2 class="title">Contents</h2>
        <div id="toc-wrapper">
          <ol id="toc-items"></ol>
        </div>
      </nav>
      

      

<p><a href="https://github.com/basho/bitcask">Bitcask</a> is an Erlang application that provides an API for storing and retrieving key/value data using log-structured hash tables that provide very fast access. The <a href="http://basho.com/assets/bitcask-intro.pdf">design</a> of Bitcask was inspired, in part, by log-structured filesystems and log file merging.</p>

<h2 id="bitcask-s-strengths:84bca2a4bc90bd8a7a392dc7596e1b9e">Bitcask&rsquo;s Strengths</h2>

<ul>
<li><p><strong>Low latency per item read or written</strong></p>

<p>This is due to the write-once, append-only nature of Bitcask
database files.</p></li>

<li><p><strong>High throughput, especially when writing an incoming stream of
random items</strong></p>

<p>Write operations to Bitcask generally saturate I/O and disk
bandwidth, which is a good thing from a performance perspective.
This saturation occurs for two reasons: because (1) data that is
written to Bitcask doesn&rsquo;t need to be ordered on disk, and (2) the
log-structured design of Bitcask allows for minimal disk head
movement during writes.</p></li>

<li><p><strong>Ability to handle datasets larger than RAM without degradation</strong></p>

<p>Access to data in Bitcask involves direct lookup from an in-memory
hash table. This makes finding data very efficient, even when
datasets are very large.</p></li>

<li><p><strong>Single seek to retrieve any value</strong></p>

<p>Bitcask&rsquo;s in-memory hash table of keys points directly to locations
on disk where the data lives. Bitcask never uses more than one disk
seek to read a value and sometimes even that isn&rsquo;t necessary due to
filesystem caching done by the operating system.</p></li>

<li><p><strong>Predictable lookup <em>and</em> insert performance</strong></p>

<p>For the reasons listed above, read operations from Bitcask have
fixed, predictable behavior. This is also true of writes to Bitcask
because write operations require, at most, one seek to the end of
the current open file followed by and append to that file.</p></li>

<li><p><strong>Fast, bounded crash recovery</strong></p>

<p>Crash recovery is easy and fast with Bitcask because Bitcask files
are append only and write once. The only items that may be lost are
partially written records at the tail of the last file that was
opened for writes. Recovery operations need to review only the last
record or two written and verify CRC data to ensure that the data is
consistent.</p></li>

<li><p><strong>Easy Backup</strong></p>

<p>In most systems, backup can be very complicated. Bitcask simplifies
this process due to its append-only, write-once disk format. Any
utility that archives or copies files in disk-block order will
properly back up or copy a Bitcask database.</p></li>
</ul>

<h2 id="weaknesses:84bca2a4bc90bd8a7a392dc7596e1b9e">Weaknesses</h2>

<ul>
<li><p>Keys must fit in memory</p>

<p>Bitcask keeps all keys in memory at all times, which means that your
system must have enough memory to contain your entire keyspace, plus
additional space for other operational components and operating-
system-resident filesystem buffer space.</p></li>
</ul>

<h2 id="installing-bitcask:84bca2a4bc90bd8a7a392dc7596e1b9e">Installing Bitcask</h2>

<p>Bitcask is the default storage engine for Riak. You can verify that
Bitcask is currently being used as the storage backend with the
<a href="/riak/kv/2.1.3/using/admin/riak-cli"><code>riak</code></a> command interface:</p>

<pre><code class="language-bash">riak config effective | grep backend
</code></pre>

<p>If this operation returns anything other than <code>bitcask</code>, read
the following section for instructions on switching the backend to Bitcask.</p>

<h2 id="enabling-bitcask:84bca2a4bc90bd8a7a392dc7596e1b9e">Enabling Bitcask</h2>

<p>You can set Bitcask as the storage engine using each node&rsquo;s
<a href="/riak/kv/2.1.3/configuring/reference">configuration files</a>:</p>

<pre><code class="language-riakconf">storage_backend = bitcask
</code></pre>

<pre><code class="language-appconfig">{riak_kv, [
  {storage_backend, riak_kv_bitcask_backend},
  %% Other riak_kv settings...

    ]},
</code></pre>

<h2 id="configuring-bitcask:84bca2a4bc90bd8a7a392dc7596e1b9e">Configuring Bitcask</h2>

<p>Bitcask enables you to configure a wide variety of its behaviors, from
filesystem sync strategy to merge settings and more.</p>

<blockquote>
<p><strong>Note on configuration systems</strong></p>

<p>Riak 2.0 enables you to use either the newer <a href="/riak/kv/2.1.3/configuring/reference">configuration system</a> based on a single <code>riak.conf</code> file or the older system, based on an <code>app.config</code> configuration file.
Instructions for both systems will be included below. Narrative
descriptions of the various settings will be tailored to the newer
configuration system, whereas instructions for the older system will
largely be contained in the code tabs.</p>
</blockquote>

<p>The default configuration values for Bitcask are as follows:</p>

<pre><code class="language-riakconf">bitcask.data_root = ./data/bitcask
bitcask.io_mode = erlang
</code></pre>

<pre><code class="language-appconfig">{bitcask, [
    {data_root, &quot;/var/lib/riak/bitcask&quot;},
    {io_mode, erlang},

    %% Other Bitcask-specific settings
    ]}
</code></pre>

<p>All of the other available settings listed below can be added to your
configuration files.</p>

<h3 id="open-timeout:84bca2a4bc90bd8a7a392dc7596e1b9e">Open Timeout</h3>

<p>The open timeout setting specifies the maximum time Bitcask will block
on startup while attempting to create or open the Bitcask data
directory. The default is 4 seconds.</p>

<p>In general, you will not need to adjust this setting. If, however, you
begin to receive log messages of the form <code>Failed to start bitcask
backend: ...</code>, you may want to consider using a longer timeout.</p>

<p>Open timeout is specified using the <code>bitcask.sync.open_timeout</code>
parameter, and can be set in terms of seconds, minutes, hours, etc.
The following example sets the parameter to 10 seconds:</p>

<pre><code class="language-riakconf">bitcask.sync.open_timeout = 10s
</code></pre>

<pre><code class="language-appconfig">{bitcask, [
    ...,
    {open_timeout, 10} %% This value must be expressed in seconds
    ...
    ]}
</code></pre>

<h3 id="sync-strategy:84bca2a4bc90bd8a7a392dc7596e1b9e">Sync Strategy</h3>

<p>Bitcask enables you to configure the durability of writes by specifying
when to synchronize data to disk, i.e. by choosing a sync strategy. The
default setting (<code>none</code>) writes data into operating system buffers that
will be written to disk when those buffers are flushed by the operating
system. If the system fails before those buffers are flushed, e.g. due
to power loss, that data is lost. This possibility holds for any
database in which values are asynchronously flushed to disk.</p>

<p>Thus, using the default setting of <code>none</code> protects against data loss in
the event of application failure, i.e. process death, but leaves open a
small window in which data could be lost in the event of a complete
system failure, e.g. hardware or OS failure.</p>

<p>This possibility can be prevented by choosing the <code>o_sync</code> sync
strategy, which forces the operating system to flush to stable storage
at write time for every write. The effect of flushing each write is
better durability, although it should be noted that write throughput
will suffer because each write will have to wait for the write to
complete.</p>

<p>The following sync strategies are available:</p>

<ul>
<li><code>none</code> &mdash; lets the operating system manage syncing writes
(default)</li>
<li><code>o_sync</code> &mdash; uses the <code>O_SYNC</code> flag, which forces syncs on every
write</li>
<li>Time interval &mdash; Riak will force Bitcask to sync at specified
intervals</li>
</ul>

<p>The following are possible configurations:</p>

<pre><code class="language-riakconf">bitcask.sync.strategy = none
bitcask.sync.strategy = o_sync

bitcask.sync.strategy = interval
bitcask.sync.interval = 65s
</code></pre>

<pre><code class="language-appconfig">{bitcask, [
    ...,
        {sync_strategy, none},
        {sync_strategy, o_sync},
        {sync_strategy, {seconds, 10}}, %% The time interval must be specified in seconds
    ...
    ]}
</code></pre>

<blockquote>
<p><strong>Sync strategy interval limitations</strong></p>

<p>Setting the sync interval to a value lower or equal to
  <code>riak_core.vnode_inactivity_timeout</code> (default: 60 seconds), will
  prevent Riak from performing handoffs.</p>

<p>A vnode must be inactive (not receive any messages) for a certain amount of time before the handoff process can start. The sync mechanism causes a message to be sent to the vnode for every sync, thus preventing the vnode from ever becoming inactive.</p>
</blockquote>

<h3 id="max-file-size:84bca2a4bc90bd8a7a392dc7596e1b9e">Max File Size</h3>

<p>The <code>max_file_size</code> setting describes the maximum permitted size for any
single data file in the Bitcask directory. If a write causes the current
file to exceed this size threshold then that file is closed, and a new
file is opened for writes. The default is 2 GB.</p>

<p>Increasing <code>max_file_size</code> will cause Bitcask to create fewer, larger
files that are merged less frequently, while decreasing it will cause
Bitcask to create more numerous, smaller files that are merged more
frequently.</p>

<p>To give an example, if your ring size is 16, your servers could see as
much as 32 GB of data in the bitcask directories before the first merge
is triggered, irrespective of your working set size. You should plan
storage accordingly and be aware that it is possible to see disk data
sizes that are larger than the working set.</p>

<p>The <code>max_file_size</code> setting can be specified using kilobytes, megabytes,
etc. The following example sets the max file size to 1 GB:</p>

<pre><code class="language-riakconf">bitcask.max_file_size = 1GB
</code></pre>

<pre><code class="language-appconfig">%% The max_file_size setting must be expressed in bytes, as in the
%% example below

{bitcask, [
    ...,
    {max_file_size, 16#40000000}, %% 1 GB expressed in bytes
    ...
    ]}
</code></pre>

<h3 id="hint-file-crc-check:84bca2a4bc90bd8a7a392dc7596e1b9e">Hint File CRC Check</h3>

<p>During startup, Bitcask will read from <code>.hint</code> files in order to build
its in-memory representation of the key space, falling back to <code>.data</code>
files if necessary. This reduces the amount of data that must be read
from the disk during startup, thereby also reducing the time required to
start up. You can configure Bitcask to either disregard <code>.hint</code> files
that don&rsquo;t contain a CRC value or to use them anyway.</p>

<p>If you are using the newer, <code>riak.conf</code>-based configuration system, you
can instruct Bitcask to disregard <code>.hint</code> files that do not contain a
CRC value by setting the <code>hintfile_checksums</code> setting to <code>strict</code> (the
default). To use Bitcask in a backward-compatible mode that allows for
<code>.hint</code> files without CRC signatures, change the setting to
<code>allow_missing</code>.</p>

<p>The following example sets the parameter to <code>strict</code>:</p>

<pre><code class="language-riakconf">bitcask.hintfile_checksums = strict
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, substitute &quot;require_hint_crc&quot; for
%% &quot;hintfile_checksums&quot;, &quot;true&quot; for &quot;strict&quot;, and &quot;false&quot; for
%% &quot;allow_missing&quot;

{bitcask, [
    ...,
    {require_hint_crc, true},
    ...
    ]}
</code></pre>

<h3 id="i-o-mode:84bca2a4bc90bd8a7a392dc7596e1b9e">I/O Mode</h3>

<p>The <code>io_mode</code> setting specifies which code module Bitcask should use for
file access. The available settings are:</p>

<ul>
<li><code>erlang</code> (default) &mdash; Writes are made via Erlang&rsquo;s built-in file API</li>
<li><code>nif</code> &mdash; Writes are made via direct calls to the POSIX C API</li>
</ul>

<p>The following example sets <code>io_mode</code> to <code>erlang</code>:</p>

<pre><code class="language-riakconf">bitcask.io_mode = erlang
</code></pre>

<pre><code class="language-appconfig">{bitcask, [
    ...,
    {io_mode, erlang},
    ...
    ]}
</code></pre>

<p>In general, the <code>nif</code> IO mode provides higher throughput for certain
workloads, but it has the potential to negatively impact the Erlang VM,
leading to higher worst-case latencies and possible throughput collapse.</p>

<h3 id="o-sync-on-linux:84bca2a4bc90bd8a7a392dc7596e1b9e"><code>O_SYNC</code> on Linux</h3>

<p>Synchronous file I/O via
<a href="http://linux.about.com/od/commands/l/blcmdl2_open.htm"><code>o_sync</code></a> is
supported in Bitcask if <code>io_mode</code> is set to <code>nif</code> and is not supported
in the <code>erlang</code> mode.</p>

<p>If you enable <code>o_sync</code> by setting <code>io_mode</code> to <code>nif</code>, however, you will
still get an incorrect warning along the following lines:</p>

<pre><code class="language-log">[warning] &lt;0.445.0&gt;@riak_kv_bitcask_backend:check_fcntl:429 {sync_strategy,o_sync} not implemented on Linux
</code></pre>

<p>If you are using the older, <code>app.config</code>-based configuration system, you
can disable the check that generates this warning by adding the
following to the <code>riak_kv</code> section of your <code>app.config</code>:</p>

<pre><code class="language-appconfig">{riak_kv, [
    ...,
    {o_sync_warning_logged, false},
    ...
    ]}
</code></pre>

<h3 id="disk-usage-and-merging-settings:84bca2a4bc90bd8a7a392dc7596e1b9e">Disk Usage and Merging Settings</h3>

<p>Riak KV stores each <a href="/riak/kv/2.1.3/learn/glossary/#Vnode">vnode</a> of the
<a href="/riak/kv/2.1.3/learn/concepts/clusters">ring</a> as a separate Bitcask directory within the
configured Bitcask data directory.</p>

<p>Each of these directories will contain multiple files with key/value
data, one or more &ldquo;hint&rdquo; files that record where the various keys exist
within the data files, and a write lock file. The design of Bitcask
allows for recovery even when data isn&rsquo;t fully synchronized to disk
(partial writes). This is accomplished by maintaining data files that
are append-only (i.e. never modified in-place) and are never reopened
for modification (i.e. they are only for reading).</p>

<p>This data management strategy trades disk space for operational
efficiency. There can be a significant storage overhead that is
unrelated to your working data set but can be tuned in a way that best
fits your use case. In short, disk space is used until a threshold is
met at which point unused space is reclaimed through a process of
merging. The merge process traverses data files and reclaims space by
eliminating out-of-date of deleted key/value pairs, writing only the
current key/value pairs to a new set of files within the directory.</p>

<p>The merge process is affected by all of the settings described in the
sections below. In those sections, &ldquo;dead&rdquo; refers to keys that no longer
contain the most up-to-date values, while &ldquo;live&rdquo; refers to keys that do
contain the most up-to-date value and have not been deleted.</p>

<h3 id="merge-policy:84bca2a4bc90bd8a7a392dc7596e1b9e">Merge Policy</h3>

<p>Bitcask enables you to select a merge policy, i.e. when during the day
merge operations are allowed to be triggered. The valid options are:</p>

<ul>
<li><code>always</code> &mdash; No restrictions on when merge operations can occur
(default)</li>
<li><code>never</code> &mdash; Merge will never be attempted</li>
<li><code>window</code> &mdash; Merge operations occur during specified hours</li>
</ul>

<p>If you are using the newer, <code>riak.conf</code>-based configuration system, you
can select a merge policy using the <code>merge.policy</code> setting. The
following example sets the merge policy to <code>never</code>:</p>

<pre><code class="language-riakconf">bitcask.merge.policy = never
</code></pre>

<pre><code class="language-appconfig">{bitcask, [
    ...,
    {merge_window, never},
    ...
    ]}
</code></pre>

<p>If you opt to specify start and end hours for merge operations, you can
do so with the <code>merge.window.start</code> and <code>merge.window.end</code>
settings in addition to setting the merge policy to <code>window</code>.
Each setting is an integer between 0 and 23 for hours on a 24h clock,
with 0 meaning midnight and 23 standing for 11 pm.
The merge window runs from the first minute of the <code>merge.window.start</code> hour
to the last minute of the <code>merge.window.end</code> hour.
The following example enables merging between 3 am and 4:59 pm:</p>

<pre><code class="language-riakconf">bitcask.merge.policy = window
bitcask.merge.window.start = 3
bitcask.merge.window.end = 17
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, you specify the merge window using
%% a tuple, as in the following example:

{bitcask, [
    ...,
    {merge_window, {3, 17}},
    ...
    ]}
</code></pre>

<blockquote>
<p><strong><code>merge_window</code> and the Multi backend</strong></p>

<p>If you are using the older configuration system and using Bitcask with
the <a href="/riak/kv/2.1.3/setup/planning/backend/multi">Multi</a> backend, please note that if you
wish to use a merge window, you <em>must</em> set it in the global <code>bitcask</code>
section of your configuration file. <code>merge_window</code> settings
in per-backend sections are ignored.</p>
</blockquote>

<p>If merging has a significant impact on performance of your cluster, or
if your cluster has quiet periods in which little storage activity
occurs, you may want to change this setting from the default.</p>

<p>A common way to limit the impact of merging is to create separate merge
windows  for each node in the cluster and ensure that these windows do
not overlap. This ensures that at most one node at a time can be
affected by merging, leaving the remaining nodes to handle requests.
The main drawback of this approach is that merges will occur less
frequently, leading to increased disk space usage.</p>

<h3 id="merge-triggers:84bca2a4bc90bd8a7a392dc7596e1b9e">Merge Triggers</h3>

<p>Merge triggers determine the conditions under which merging will be
invoked. These conditions fall into two basic categories:</p>

<ul>
<li><p><strong>Fragmentation</strong> &mdash; This describes the ratio of dead keys to total
keys in a file that will trigger merging. The value of this setting is
an integer percentage (0-100). For example, if a data file contains 6
dead keys and 4 live keys, a merge will be triggered by the default
setting (60%). Increasing this value will cause merging to occur less
often, whereas decreasing the value will cause merging to happen more
often.</p></li>

<li><p><strong>Dead Bytes</strong> &mdash; This setting describes how much data stored for
dead keys in a single file will trigger merging. If a file meets or
exceeds the trigger value for dead bytes, a merge will be triggered.
Increasing the value will cause merging to occur less often, whereas
decreasing the value will cause merging to happen more often. The
default is 512 MB.</p></li>
</ul>

<p>When either of these constraints are met by any file in the directory,
  Bitcask will attempt to merge files.</p>

<p>You can set the triggers described above using
<code>merge.triggers.fragmentation</code> and <code>merge.triggers.dead_bytes</code>,
respectively. The former is expressed as an integer between 0 and 100,
whereas the latter can be expressed in terms of kilobytes, megabytes,
gigabytes, etc. The following example sets the dead bytes threshold to
55% and the fragmentation threshold to 1 GB:</p>

<pre><code class="language-riakconf">bitcask.merge.triggers.fragmentation = 55
bitcask.merge.triggers.dead_bytes = 1GB
</code></pre>

<pre><code class="language-appconfig">%% The equivalent settings in the app.config-based system are
%% frag_merge_trigger and dead_bytes_merge_trigger, respectively. The
%% latter must be expressed in bytes.

{bitcask, [
    ...,
    {frag_merge_trigger, 55},
    {dead_bytes_merge_trigger, 1073741824},
    ...
    ]}
</code></pre>

<h3 id="merge-thresholds:84bca2a4bc90bd8a7a392dc7596e1b9e">Merge Thresholds</h3>

<p>Merge thresholds determine which files will be chosen for inclusion in
a merge operation.</p>

<ul>
<li><p><strong>Fragmentation</strong> &mdash; This setting describes which ratio of dead keys
to total keys in a file will cause it to be included in the merge. The
value of this setting is a percentage (0-100). For example, if a data
file contains 4 dead keys and 6 live keys, it will be included in the
merge at the default ratio (40%). Increasing the value will cause
fewer files to be merged, while decreasing the value will cause more
files to be merged.</p></li>

<li><p><strong>Dead Bytes</strong> &mdash; This setting describes which ratio the minimum
amount of data occupied by dead keys in a file to cause it to be
included in the merge. Increasing this value will cause fewer files to
be merged, while decreasing this value will cause more files to be
merged. The default is 128 MB.</p></li>

<li><p><strong>Small File</strong> &mdash; This setting describes the minimum size a file must
be to be <em>excluded</em> from the merge. Files smaller than the threshold
will be included. Increasing the value will cause more files to be
merged, while decreasing the value will case fewer files to be merged.
The default is 10 MB.</p></li>
</ul>

<p>You can set the thresholds described above using the
<code>merge.thresholds.fragmentation</code>, <code>merge.thresholds.dead_bytes</code>, and
<code>merge.threshold.small_file</code> settings, respectively.</p>

<p>The <code>fragmentation</code> setting is expressed as an integer
between 0 and 100, and the <code>dead_bytes</code> and <code>small_file</code> settings can be
expressed in terms of kilobytes, megabytes, gigabytes, etc. The
following example sets the fragmentation threshold to 45%, the
dead bytes threshold to 200 MB, and the small file threshold to 25 MB:</p>

<pre><code class="language-riakconf">bitcask.merge.thresholds.fragmentation = 45
bitcask.merge.thresholds.dead_bytes = 200MB
bitcask.merge.thresholds.small_file = 25MB
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, the settings corresponding to those
%% listed above are frag_threshold, dead_bytes_threshold, and
%% small_files threshold, respectively. The latter two settings must be
%% expressed in bytes:

{bitcask, [
    ...,
    {frag_threshold, 45},
    {dead_bytes_threshold, 209715200},
    {small_file_threshold, 26214400},
    ...
    ]}
</code></pre>

<blockquote>
<p><strong>Note on choosing threshold values</strong></p>

<p>The values for the fragmentation and dead bytes thresholds <em>must be
equal to or less than their corresponding trigger values</em>. If they are
set higher, Bitcask will trigger merges in cases where no files meet the
threshold, which means that Bitcask will never resolve the conditions
that triggered merging in the first place.</p>
</blockquote>

<h3 id="merge-interval:84bca2a4bc90bd8a7a392dc7596e1b9e">Merge Interval</h3>

<p>Bitcask periodically runs checks to determine whether merges are
necessary. You can determine how often those checks take place using
the <code>bitcask.merge_check_interval</code> parameter. The default is 3 minutes.</p>

<pre><code class="language-riakconf">bitcask.merge_check_interval = 3m
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, this setting is expressed in
%% milliseconds and found in the riak_kv section rather than the bitcask
%% section:

{riak_kv, [
    %% Other configs

    {bitcask_merge_check_interval, 180000},

    %% Other configs
    ]}
</code></pre>

<p>If merge check operations happen at the same time on different
<a href="/riak/kv/2.1.3/learn/glossary/#Vnode">vnodes</a> on the same node, this can produce spikes
in I/O usage and undue latency. Bitcask makes it less likely that merge
check operations will occur at the same time on different vnodes by
applying a <strong>jitter</strong> to those operations. A jitter is a random
variation applied to merge times that you can alter using the
<code>bitcask.merge_check_jitter</code> parameter. This parameter is expressed as a
percentage of <code>bitcask.merge_check_interval</code>. The default is 30%.</p>

<pre><code class="language-riakconf">bitcask.merge_check_jitter = 30%
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, this setting is expressed as a float
%% and found in the riak_kv section rather than the bitcask section:

{riak_kv, [
    %% Other configs

    {bitcask_merge_check_jitter, 0.3},

    %% Other configs
    ]}
</code></pre>

<p>For example, if you set the merge check interval to 4 minutes and the
jitter to 25%, merge checks will occur at intervals between 3 and 5
minutes. With the default of 3 minutes and 30%, checks will occur at
intervals between roughly 2 and 4 minutes.</p>

<h3 id="log-needs-merge:84bca2a4bc90bd8a7a392dc7596e1b9e">Log Needs Merge</h3>

<p>If you are using the older, <code>app.config</code>-based configuration system, you
can use the <code>log_needs_merge</code> setting to tune and troubleshoot Bitcask
merge settings. When set to <code>true</code> (as in the example below), each time
a merge trigger is met, the partition/vnode ID and mergeable files will
be logged.</p>

<pre><code class="language-appconfig">{bitcask, [
    ...,
    {log_needs_merge, true},
    ...
    ]}
</code></pre>

<blockquote>
<p><strong>Note on <code>log_needs_merge</code> and the Multi backend</strong></p>

<p>If you are using Bitcask with the <a href="/riak/kv/2.1.3/setup/planning/backend/multi">Multi</a> backend in conjunction with the older, <code>app.config</code>-based configuration system, please
note that <code>log_needs_merge</code> <em>must</em> be set in the global <code>bitcask</code> section of your <code>app.config</code>. All <code>log_needs_merge</code> settings in per-backend sections are ignored.</p>
</blockquote>

<h3 id="fold-keys-threshold:84bca2a4bc90bd8a7a392dc7596e1b9e">Fold Keys Threshold</h3>

<p>Fold keys thresholds will reuse the keydir (a) if another fold was
started less than a specified time interval ago and (b) there were fewer
than a specified number of updates. Otherwise, Bitcask will wait until
all current fold keys complete and then start. The default time interval
is 0, while the default number of updates is unlimited. Both thresholds
can be disabled.</p>

<p>The conditions described above can be set using the <code>fold.max_age</code> and
<code>fold.max_puts</code> parameters, respectively. The former can be expressed in
terms of minutes, hours, days, etc., while the latter is expressed as an
integer. Each threshold can be disabled by setting the value to
<code>unlimited</code>. The following example sets the <code>max_age</code> to <sup>1</sup>&frasl;<sub>2</sub> second and
the <code>max_puts</code> to 1000:</p>

<pre><code class="language-riakconf">bitcask.max_age = 0.5s
bitcask.max_puts = 1000
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, the corresponding parameters are
%% max_fold_age and max_fold_puts, respectively. The former must be
%% expressed in milliseconds, while the latter must be an integer:

{bitcask, [
    ...,
    {max_fold_age, 500},
    {max_fold_puts, 1000},
    ...
    ]}

%% Each of these thresholds can be disabled by setting the value to -1
</code></pre>

<p><a name="Automatic-Expiration"></a></p>

<h3 id="automatic-expiration:84bca2a4bc90bd8a7a392dc7596e1b9e">Automatic Expiration</h3>

<p>By default, Bitcask keeps all of your data. But if your data has limited
time value or if you need to purge data for space reasons, you can
configure object expiration, aka expiry. This feature is disabled by
default.</p>

<p>You can enable and configure object expiry using the <code>expiry</code> setting
and either specifying a time interval in seconds, minutes, hours, etc.,
or turning expiry off (<code>off</code>). The following example configures objects
to expire after 1 day:</p>

<pre><code class="language-riakconf">bitcask.expiry = 1d
</code></pre>

<pre><code class="language-appconfig">%% In the app.config-based system, expiry is expressed in terms of
%% seconds:

{bitcask, [
    ...,
    {expiry_secs, 86400}, %% Sets the duration to 1 day
    ...
    ]}

%% Expiry can be turned off by setting this value to -1
</code></pre>

<blockquote>
<p><strong>Note on stale data</strong></p>

<p>Space occupied by stale data <em>may not be reclaimed immediately</em>,
but the data will become immediately inaccessible to client requests.
Writing to a key will set a new modification timestamp on the value
and prevent it from being expired.</p>
</blockquote>

<p>By default, Bitcask will trigger a merge whenever a data file contains
an expired key. This may result in excessive merging under some usage
patterns. You can prevent this by configuring an expiry grace time.
Bitcask will defer trigger a merge solely for key expiry by the
configured amount of time. The default is 0, signifying no grace time.</p>

<p>If you are using the newer, <code>riak.conf</code>-based configuration system, you
can set an expiry grace time using the <code>expiry.grace_time</code> setting and
in terms of minutes, hours, days, etc. The following example sets the
grace period to 1 hour:</p>

<pre><code class="language-riakconf">bitcask.expiry.grace_time = 1h
</code></pre>

<pre><code class="language-appconfig">%% The equivalent setting in the app.config-based system is
%% expiry_grace_time. This must be expressed in seconds:

{bitcask, [
    ...,
    {expiry_grace_time, 3600}, %% Sets the grace period to 1 hour
    ...
    ]}
</code></pre>

<h4 id="automatic-expiration-and-riak-search:84bca2a4bc90bd8a7a392dc7596e1b9e">Automatic expiration and Riak Search</h4>

<p>If you are using <a href="/riak/kv/2.1.3/developing/usage/search">Riak Search</a> in conjunction with
Bitcask, please be aware that automatic expiry does not apply to <a href="/">Search Indexes</a>. If objects are indexed using Search,
those objects can be expired by Bitcask yet still registered in Search
indexes, which means that Search queries may return keys that no longer
exist. Riak&rsquo;s <a href="/riak/kv/2.1.3/learn/glossary/#Active-Anti-Entropy-AAE-">active anti-entropy (AAE)</a> subsystem will eventually
catch this discrepancy, but this depends on AAE being enabled (which is
the default) and could take some time. If search queries returning
expired keys is a problem for your use case, then we would recommend not
using automatic expiration.</p>

<h2 id="tuning-bitcask:84bca2a4bc90bd8a7a392dc7596e1b9e">Tuning Bitcask</h2>

<p>When tuning your environment, there are a number of things to bear in
mind that can assist you in making Bitcask as stable and reliable as
possible and to minimize latency and maximize throughput.</p>

<h3 id="tips-tricks:84bca2a4bc90bd8a7a392dc7596e1b9e">Tips &amp; Tricks</h3>

<ul>
<li><p><strong>Bitcask depends on filesystem caches</strong></p>

<p>Some data storage layers implement their own page/block buffer cache
in-memory, but Bitcask does not. Instead, it depends on the
filesystem&rsquo;s cache. Adjusting the caching characteristics of your
filesystem can impact performance.</p></li>

<li><p><strong>Be aware of file handle limits</strong></p>

<p>Review the documentation on <a href="/riak/kv/2.1.3/using/performance/open-files-limit">open files limit</a>.</p></li>

<li><p><strong>Avoid the overhead of updating file metadata (such as last access
time) on every read or write operation</strong></p>

<p>You can achieve a substantial speed boost by adding the <code>noatime</code>
mounting option to Linux&rsquo;s <code>/etc/fstab</code>. This will disable the
recording of the last accessed time for all files, which results
in fewer disk head seeks. If you need last access times but you&rsquo;d
like some of the benefits of this optimization, you can try
<code>relatime</code>.</p>

<pre><code>/dev/sda5    /data           ext3    noatime  1 1
/dev/sdb1    /data/inno-log  ext3    noatime  1 2
</code></pre></li>

<li><p><strong>Small number of frequently changed keys</strong></p>

<p>When keys are changed frequently, fragmentation rapidly increases.
To counteract this, you should lower the fragmentation trigger and
threshold.</p></li>

<li><p><strong>Limited disk space</strong></p>

<p>When disk space is limited, limiting the space occupied by dead keys
is of paramount importance. Lower the dead bytes threshold and
trigger to counteract wasted space.</p></li>

<li><p><strong>Purging stale entries after a fixed period</strong></p>

<p>To automatically purge stale values, set the object expiry value to
the desired cutoff time. Keys that are not modified for a period
equal to or greater than this time interval will become
inaccessible.</p></li>

<li><p><strong>High number of partitions per node</strong></p>

<p>Because each cluster has many partitions running, Bitcask will have
many <a href="/riak/kv/2.1.3/using/performance/open-files-limit">open files</a>. To reduce the number of open
files, we suggest increasing the max file size so that larger files
will be written. You could also decrease the fragmentation and
dead-bytes settings and increase the small file threshold so that
merging will keep the number of open files small in number.</p></li>

<li><p><strong>High daytime traffic, low nighttime traffic</strong></p>

<p>In order to cope with a high volume of writes without performance
degradation during the day, you might want to limit merging to
in non-peak periods. Setting the merge window to hours of the day
when traffic is low will help.</p></li>

<li><p><strong>Multi-cluster replication (Riak Enterprise)</strong></p>

<p>If you are using <a href="http://basho.com/riak-enterprise/">Riak Enterprise</a>
with the replication feature enabled, your clusters might experience
higher production of fragmentation and dead bytes. Additionally,
because the fullsync feature operates across entire partitions, it
will be made more efficient by accessing data as sequentially as
possible (across fewer files). Lowering both the fragmentation and
dead-bytes settings will improve performance.</p></li>
</ul>

<h2 id="faq:84bca2a4bc90bd8a7a392dc7596e1b9e">FAQ</h2>

<ul>
<li>[[Why does it seem that Bitcask merging is only triggered when a
Riak node is restarted?|Developing on Riak
FAQs#why-does-it-seem-that-bitc]]</li>
<li>[[If the size of key index exceeds the amount of memory, how does
Bitcask handle it?|Operating Riak FAQs#if-the-size-of-key-index-e]]</li>
<li><a href="/riak/kv/2.1.3/setup/planning/bitcask-capacity-calc">Bitcask Capacity Planning</a></li>
</ul>

<h2 id="bitcask-implementation-details:84bca2a4bc90bd8a7a392dc7596e1b9e">Bitcask Implementation Details</h2>

<p>Riak will create a Bitcask database directory for each <a href="/riak/kv/2.1.3/learn/glossary/#Vnode">vnode</a>
in a <a href="/riak/kv/2.1.3/learn/concepts/clusters">cluster</a>. In each of those directories, at most one
database file will be open for writing at any given time. The file being
written to will grow until it exceeds a specified size threshold, at
which time it is closed and a new file is created for additional writes.
Once a file is closed, whether purposely or due to server exit, it is
considered immutable and will never again be opened for writing.</p>

<p>The file currently open for writes is only written by appending, which
means that sequential writes do not require disk seeking, which can
dramatically speed up disk I/O. Note that this effect can be hampered if
you have <code>atime</code> enabled on your filesystem, because the disk head will
have to move to update both the data blocks <em>and</em> the file and directory
metadata blocks. The primary speed advantage from a log-based database
stems of its ability to minimize disk head seeks.</p>

<p>Deleting a value from Bitcask is a two-step process: first, a
<a href="/riak/kv/2.1.3/developing/usage/deleting-objects">tombstone</a> is recorded in the open file for writes,
which indicates that a value was marked for deletion at that time, while
references to that key are removed from the in-memory &ldquo;keydir&rdquo;
information; later, during a merge operation, non-active data files are
scanned, and only  those values without tombstones are merged into the
active data file. This effectively removes the obsolete data and
reclaims disk space associated with it. This data management strategy
may use up a lot of space over time, since Bitcask writes new values
without touching the old ones.</p>

<p>The compaction process referred to as &ldquo;merging&rdquo; solves this
problem. The merge process iterates over all non-active (i.e. immutable)
files in a Bitcask database and produces as output a set of data files
containing only the &ldquo;live&rdquo; or latest versions of each present key.</p>

<h3 id="bitcask-database-files:84bca2a4bc90bd8a7a392dc7596e1b9e">Bitcask Database Files</h3>

<p>Below are two directory listings showing what you should expect to find
on disk when using Bitcask. In this example, we use a 64-partition
<a href="/riak/kv/2.1.3/learn/concepts/clusters">ring</a>, which results in 64 separate directories,
each holding its own Bitcask database.</p>

<pre><code class="language-bash">ls ./data/bitcask
</code></pre>

<p>The result:</p>

<pre><code>0
1004782375664995756265033322492444576013453623296
1027618338748291114361965898003636498195577569280

... etc ...

981946412581700398168100746981252653831329677312
</code></pre>

<p>Note that when starting up the directories are created for each
<a href="/riak/kv/2.1.3/learn/glossary/#Vnode">vnode</a> partition&rsquo;s data. At this point, however, there are not
yet any Bitcask-specific files.</p>

<p>After performing one PUT (write) into the Riak cluster running Bitcask:</p>

<pre><code class="language-bash">curl -XPUT http://localhost:8098/types/default/buckets/test/keys/test \
  -H &quot;Content-Type: text/plain&quot; \
  -d &quot;hello&quot;
</code></pre>

<p>The &ldquo;N&rdquo; value for this cluster is 3 (the default), so you&rsquo;ll see that
the three vnode partitions responsible for this data now have Bitcask
database files:</p>

<pre><code>bitcask/

... etc ...

|-- 1118962191081472546749696200048404186924073353216-1316787078245894
|   |-- 1316787252.bitcask.data
|   |-- 1316787252.bitcask.hint
|   `-- bitcask.write.lock

... etc ...


|-- 1141798154164767904846628775559596109106197299200-1316787078249065
|   |-- 1316787252.bitcask.data
|   |-- 1316787252.bitcask.hint
|   `-- bitcask.write.lock

... etc ...


|-- 1164634117248063262943561351070788031288321245184-1316787078254833
|   |-- 1316787252.bitcask.data
|   |-- 1316787252.bitcask.hint
|   `-- bitcask.write.lock

... etc ...

</code></pre>

<p>As more data is written to the cluster, more Bitcask files are created
until merges are triggered.</p>

<pre><code>bitcask/
|-- 0-1317147619996589
|   |-- 1317147974.bitcask.data
|   |-- 1317147974.bitcask.hint
|   |-- 1317221578.bitcask.data
|   |-- 1317221578.bitcask.hint
|   |-- 1317221869.bitcask.data
|   |-- 1317221869.bitcask.hint
|   |-- 1317222847.bitcask.data
|   |-- 1317222847.bitcask.hint
|   |-- 1317222868.bitcask.data
|   |-- 1317222868.bitcask.hint
|   |-- 1317223014.bitcask.data
|   `-- 1317223014.bitcask.hint
|-- 1004782375664995756265033322492444576013453623296-1317147628760580
|   |-- 1317147693.bitcask.data
|   |-- 1317147693.bitcask.hint
|   |-- 1317222035.bitcask.data
|   |-- 1317222035.bitcask.hint
|   |-- 1317222514.bitcask.data
|   |-- 1317222514.bitcask.hint
|   |-- 1317223035.bitcask.data
|   |-- 1317223035.bitcask.hint
|   |-- 1317223411.bitcask.data
|   `-- 1317223411.bitcask.hint
|-- 1027618338748291114361965898003636498195577569280-1317223690337865
|-- 1050454301831586472458898473514828420377701515264-1317223690151365

... etc ...

</code></pre>

<p>This is normal operational behavior for Bitcask.</p>


      <div class="clear"></div>

    </article>

    <footer class="mastfooter">
    This work is licensed under a
    <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 International Public License
    </a><br>
    &copy; 2011-2016&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
</footer>


  </div>

  <script src="/js/all.js" type="text/javascript"></script>
<script type= "text/javascript">
  
  hljs.configure({languages: []});
  hljs.initHighlighting();

  
  
  
  $(function() {
    $(".js_enabled pre").css("visibility", "visible");
  });
</script>


</body>
</html>
