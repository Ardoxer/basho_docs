<!DOCTYPE html>

<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"></html><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"></html><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"></html><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->




<head class="tutorials">
  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <meta name="project" content="riak_kv">
  <meta name="version" content="2.1.3">
  <meta name="base-url" content="">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <title>Benchmarking</title>

  <link href="/css/all.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/css/print.css" media="print" rel="stylesheet" type="text/css">

  
  <style type="text/css"> .js_enabled pre { visibility : hidden; } </style>
  <script type="text/javascript">
    document.documentElement.className = 'js_enabled';
  </script>
</head>



<body class="riak_kv 2.1.3 latest ">

  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>

  
<aside id="nav-container" role="complementary">
  <nav class="overview" id="primary-nav" role="nav">
    <div id="primary-nav-content">
      <h2 class="responsive-link"><a class="responsive-toggle"></a></h2>

      
      <form id="searchbox_011972015458788978446:zgdcy4fa-o0" action="">
        <div class="nav-field-container">
          <div id="icon-container-search">
            <div class="icon-container"><span aria-hidden="true" class="nav-icon-search icon-search"></span></div>
            <span class="separator">&#124;</span>
          </div>
          <input id="main-search" name="q" placeholder="Search" size="5" type="search" />
        </div>
      </form>

      <div class="clear"></div>

      
      <h3 class="responsive-link visit-basho">
        <a href="http://www.basho.com">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">Visit Basho</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      <h3 class="responsive-link">
        <a href="/index.html">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">All Riak Projects</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-riak"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/">Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-download-alt"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/downloads/">Download Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-install"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/setup/">Setup</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/">Planning</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/start/">Start Planning</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/operating-system/">OS Support</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/backend/">Choosing a Backend</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/bitcask/">Bitcask</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/leveldb/">LevelDB</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/memory/">Memory</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/multi/">Multi-backend</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/cluster-capacity/">Cluster Capacity</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/bitcask-capacity-calc/">Bitcask Capacity Calculator</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/future/">Planning for the Future</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/">Installing</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/amazon-web-services/">Amazon Web Services</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/debian-ubuntu/">Debian &amp; Ubuntu</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/freebsd/">FreeBSD</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/mac-osx/">Mac OS X</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/rhel-centos/">RHEL &amp; CentOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/smartos/">SmartOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/solaris/">Solaris</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/suse/">SUSE</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/windows-azure/">Windows Azure</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/source/">Installing From Source</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/erlang/">Installing Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/jvm/">Installing the JVM</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/verify/">Verifying an Installation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/upgrading/">Upgrading</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/checklist/">Production Checklist</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/version/">Upgrading by Version</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/cluster/">Upgrading a Cluster</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/multi-datacenter/">Upgrading Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/downgrade/">Downgrading</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-cog"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/configuring/">Configuring</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/basic/">Basic Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/backend/">Backend Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/managing/">Managing Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/reference/">Configuration Reference</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/strong-consistency/">Implementing Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/load-balancing-proxy/">Load Balancing &amp; Proxy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/mapreduce/">MapReduce Settings</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/search/">Search Settings</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/">V3 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/">V2 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-database"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/using/">Using</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/running-a-cluster/">Running a Cluster</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/admin/">Cluster Administration</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/commands/">Cluster Admin Commands</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-admin/">riak-admin CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-cli/">riak CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-control/">Riak Control</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/cluster-operations/">Cluster Operations</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/adding-removing-nodes/">Adding/Removing Nodes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/changing-cluster-info/">Changing Cluster Information</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/replacing-node/">Replacing a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/inspecting-node/">Inspecting a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backing-up/">Backing Up</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/secondary-indexes/">Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/monitoring-strong-consistency/">Monitoring Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/load-balancing/">Load Balancing</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backend/">Backend</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v3-multi-datacenter/">V3 Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v2-multi-datacenter/">V2 Multi-Datacenter</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/repair-recovery/">Repair &amp; Recovery</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/errors/">Errors</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/repairs/">Repairs</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/rolling-restart/">Rolling Restarts</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/security/">Security</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/basics/">Security Basics</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/managing-sources/">Managing Security Sources</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/v2-v3-ssl-ca/">V2/V3 SSL &amp; CA Validation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/performance/">Performance</a></span></h4>
    
<ul class="depth-2">
  
  <li class="current">
  
    <a href="/riak/kv/2.1.3/using/performance/benchmarking/">Benchmarking</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/open-files-limit/">Open Files Limit</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/v2-scheduling-fullsync/">V2 Scheduling Fullsync</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/multi-datacenter-tuning/">Multi-Datacenter Replication</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/">Troubleshooting</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/">Product Advisories</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/210-dataloss/">Default Configuration For Handoff May Cause Data Loss</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/appconfig-foward/">Forward Incompatibility of app.config</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/dvv-lastwritewins/">Incompatibility between Dotted Version Vectors and Last Write Wins</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/maps-204/">Map Data Type Disk Incompatibility</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/ssl-poodle/">SSL 3.0 Vulnerability and POODLE Attack</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/http-204/">HTTP 204</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/reference/">Reference</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/runtime-interaction/">Runtime Interaction</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/monitoring/">Monitoring</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/search-secondary-indexes/">Search &amp; Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/multi-datacenter/">Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v3/">V3 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v2/">V2 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/architecture/">Architecture</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-lambda"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/developing/">Developing</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/">Getting Started</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/java/">Java</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/ruby/">Ruby</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/python/">Python</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/csharp/">C Sharp</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/nodejs/">NodeJS</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/erlang/">Erlang</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/golang/">Go</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/php/">PHP</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/querying/">Querying</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/">Usage</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/creating-objects/">Creating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/reading-objects/">Reading Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/updating-objects/">Updating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/deleting-objects/">Deleting Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/content-types/">Content Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search/">Searching</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/mapreduce/">Using MapReduce</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/secondary-indexes/">Using Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/commit-hooks/">Using Commit Hooks</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search-schemas/">Creating Search Schemas</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/searching-data-types/">Searching with Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/document-store/">Implementing a Document Store</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/custom-extractors/">Custom Extractors</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/security/">Security</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/erlang/">Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/php/">PHP</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/replication/">Replication</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/">Conflict Resolution</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/csharp/">C Sharp</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/nodejs/">NodeJS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/php/">PHP</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/golang/">Go</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-types/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-modeling/">Data Modeling</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/app-guide/">Application Guide</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/replication-properties/">Replication Properties</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/write-once/">Write Once</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/reference/">Reference</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/client-libraries/">Client Libraries</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/api/">APIs</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/repl-hooks/">V2 Multi-Datacenter REPL Hooks API</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/backend/">Backend API</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/faq/">Developing FAQ</a>
  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-beaker"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/learn/">Learning</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/why-riak-kv/">Why Riak KV?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/use-cases/">Use Cases</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/new-to-nosql/">New to NoSQL?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/glossary/">Riak KV Glossary</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/learn/concepts/">Concepts</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/active-anti-entropy/">Active Anti-Entropy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/buckets/">Buckets</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/capability-negotiation/">Capability Negotiation</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/causal-context/">Causal Context</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/clusters/">Clusters</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/crdts/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/eventual-consistency/">Eventual Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/keys-and-objects/">Keys and Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/replication/">Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/vnodes/">Vnodes</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-comments"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/community">Community</a></span>
        <div class="clear"></div>
      </h3>
      <ul></ul> 
    </div>
  </nav>

  
  <ul id="fixed-nav">
    <li>
      <a href="https://github.com/basho/basho_docs" target="_blank">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xe004;"></span>
        </div>
        <span class="separator">&#124;</span>Available on GitHub
      </a>
    </li>
    <li>
      <a href="/riak/latest/community/">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xf059;"></span>
        </div>
        <span class="separator">&#124;</span>Get Help
      </a>
    </li>
  </ul>
</aside>


  <script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>


  <div role="main">

    <header class="masthead">
  <div id="header">
    
    <div id="header-inner">
      <div class="icon-reorder" id="nav-toggle"></div>

      <div id="top-nav">
        
        <a href="/riak/kv/2.1.3/downloads/"><span class="icon-download-alt"></span>Downloads</a>
        <div id="nav-more"><span class="icon-more"></span></div>
      </div>

      <a class="responsive-toggle"></a>
      
      
      <a class="logo" href="/index.html"><h1>Riak Docs</h1></a>
      
      <span class="tagline">Product tutorials, how-tos, and fully-documented APIs.</span>
      <div id="nav-menu">
        <h2>Links</h2>
        <ul>
          <li><a href="http://docs.basho.com/">Docs Home</a></li>
          <li><a href="http://basho.com/">Basho Website</a></li>
        </ul>
        
        <div id="nav-menu-arrow"></div>
        <div id="nav-menu-arrow-back"></div>
      </div>

      <div class="clear"></div>

      <div class="header-rule"></div>
    </div>
  </div>
</header>


    <article class="mainarticle">

      <div class="versions">
  <div id="version-ddown-button" class="unselected">
    <div class="version-ddown-title">Version</div>
    <div class="version-ddown-number">2.1.3</div>
    <div class="version-ddown-arrow"></div>
  </div>
  <ol id="version-list" style="display: none;">
  
  
    
    
      
      
      <li class="sans versions-0 current">DEV</li>
      
      <li class="current versions-0"><a class="versioned" href="/riak/kv/2.1.3/using/performance/benchmarking/">2.1.3</a></li>
    
    
      
      
      
      <li class=" versions-0 first"><a class="versioned" href="/riak/kv/2.1.1/using/performance/benchmarking/">2.1.1</a></li>
    
  
    
    
      
      
      
      <li class="sans versions-1 current">LTS</li>
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.6/using/performance/benchmarking/">2.0.6</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.5/using/performance/benchmarking/">2.0.5</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.4/using/performance/benchmarking/">2.0.4</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.2/using/performance/benchmarking/">2.0.2</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.1/using/performance/benchmarking/">2.0.1</a></li>
    
    
      
      
      
      <li class=" versions-1 first"><a class="versioned" href="/riak/kv/2.0.0/using/performance/benchmarking/">2.0.0</a></li>
    
  
  
  <li class="versions-5 first"><a class="sans versioned" href="http://docs.basho.com/riak/1.4.12/">older</a></li>
  </ol>
</div>


      
      

      <header><h1>Benchmarking</h1></header>

      

      
      <nav id="toc">
        <h2 class="title">Contents</h2>
        <div id="toc-wrapper">
          <ol id="toc-items"></ol>
        </div>
      </nav>
      

      

<p>Basho Bench is a benchmarking tool created to conduct accurate and
repeatable performance tests and stress tests, and to produce
performance graphs.</p>

<p>Basho Bench exposes a pluggable driver interface and has been extended
to serve as a benchmarking tool against a variety of projects. New
drivers can be written in Erlang and are generally less than 200 lines
of code.</p>

<h2 id="installation:4e0a3a2ad4748115aedce09826462c7a">Installation</h2>

<p>You will need:</p>

<ol>
<li>One or more load-generating machines on which to install
<code>basho_bench</code>.  Especially when testing larger clusters, a
single machine cannot generate enough load to properly exercise
the cluster.  Do not run the <code>basho_bench</code> instances on the
Riak nodes themselves, since the load generation will compete with
Riak for resources.</li>
<li>The <a href="http://www.r-project.org/">R statistics language</a> must be
installed (somewhere available to you) if you wish to generate
graphs (see the [[Generating Benchmark Graphs|Basho
Bench#Generating-Benchmark-Graphs]] section, below).</li>
</ol>

<h3 id="download-basho-bench:4e0a3a2ad4748115aedce09826462c7a">Download <code>basho_bench</code></h3>

<p>You can download the pre-built packages below, or build it from source.</p>

<ul>
<li><strong>Ubuntu 14.04 LTS:</strong>
<a href="http://ps-tools.s3.amazonaws.com/basho-bench_0.10.0.53.g0e15158-ubuntu14.04LTS-1_amd64.deb">basho-bench_0.10.0.53-1_amd64.deb</a></li>
<li><strong>CentOS 7:</strong>
<a href="http://ps-tools.s3.amazonaws.com/basho-bench-0.10.0.53.g0e15158-1.el7.centos.x86_64.rpm">basho-bench-0.10.0.53-1.el7.centos.x86_64.rpm</a></li>
</ul>

<h3 id="building-from-source:4e0a3a2ad4748115aedce09826462c7a">Building from Source</h3>

<h4 id="prerequisites:4e0a3a2ad4748115aedce09826462c7a">Prerequisites</h4>

<ul>
<li>Erlang must be installed. See [[Installing Erlang]] for instructions
and versioning requirements. Note: Unless you&rsquo;re an experienced
Erlang developer, we recommend that you use Ubuntu 14.04 LTS (and
not CentOS), when building <code>basho_bench</code> from source.  Later
versions of CentOS (6 and 7) have difficulty with installing and
enabling certain parts of the <code>erlang-crypto</code> package, which
is required by <code>basho_bench</code>.</li>
<li>Install <code>git</code> (to check out the <code>basho_bench</code> code)</li>
</ul>

<h4 id="compiling:4e0a3a2ad4748115aedce09826462c7a">Compiling</h4>

<pre><code class="language-bash">git clone git://github.com/basho/basho_bench.git
cd basho_bench
make
</code></pre>

<h2 id="usage:4e0a3a2ad4748115aedce09826462c7a">Usage</h2>

<p>Run the <code>basho_bench</code> script, pass in the config file and the
directory to generate the results into:</p>

<pre><code class="language-bash">basho_bench --results-dir &lt;results dir&gt; &lt;config file&gt;
</code></pre>

<p>If you&rsquo;ve installed <code>basho_bench</code> from a pre-built package, you
must specify full paths for the test results directory and config
file. (Also, don&rsquo;t use the common <code>~/</code> shell notation, specify the
user&rsquo;s home directory explicitly)</p>

<pre><code class="language-bash">basho_bench --results-dir /home/username/bench_results/ /etc/basho_bench/riakc_pb.config 
</code></pre>

<p>The example above will generate results in</p>

<pre><code class="language-/home/username/bench_results/current/```.">
If you built ```basho_bench``` from source, you can get away with
relative paths (and the results directory will be created in the
current directory):

```bash
./basho_bench myconfig.config
</code></pre>

<p>This will generate results in <code>tests/current/</code>. You will need to
create a configuration file. The recommended approach is to start from
a file in the <code>examples</code> directory and modify settings using the
[[Configuration|Basho Bench#Configuration]] section below for
reference.</p>

<h2 id="generating-benchmark-graphs:4e0a3a2ad4748115aedce09826462c7a">Generating Benchmark Graphs</h2>

<p>The output of from running the <code>basho_bench</code> script can be used to
create graphs showing the following:</p>

<ul>
<li>Throughput &mdash; Operations per second over the duration of the test.</li>
<li>Latency at 99th percentile, 99.9th percentile and max latency for
the selected operations.</li>
<li>Median latency, mean latency, and 95th percentile latency for the
selected operations.</li>
</ul>

<h3 id="prerequisites-1:4e0a3a2ad4748115aedce09826462c7a">Prerequisites</h3>

<p>The R statistics language is needed to generate graphs. Note: If
necessary, R can be installed on a different machine than the one
running basho_bench, and the performance data can be copied (via
rsync, for example) from the load testing machine to the one that will
be generating and viewing the graphs (such as a desktop).</p>

<h4 id="installing-r-on-ubuntu:4e0a3a2ad4748115aedce09826462c7a">Installing R on Ubuntu</h4>

<pre><code>sudo apt-get install r-base
</code></pre>

<h4 id="installing-r-on-other-platforms:4e0a3a2ad4748115aedce09826462c7a">Installing R on Other Platforms</h4>

<ul>
<li>More information: [[<a href="http://www.r-project.org/]">http://www.r-project.org/]</a>]</li>
<li>Download R: [[<a href="http://cran.r-project.org/mirrors.html]">http://cran.r-project.org/mirrors.html]</a>]</li>
</ul>

<p>Follow the instructions for your platform to install R.</p>

<h3 id="generating-graphs:4e0a3a2ad4748115aedce09826462c7a">Generating Graphs</h3>

<p>If you have installed <code>basho_bench</code> from a pre-built package, and
you also have R installed on the same machine, you can generate the
current result graph with the following:</p>

<pre><code class="language-bash">Rscript --vanilla /usr/lib/basho_bench/lib/basho_bench*/priv/summary.r -i /home/username/bench_results/current/
</code></pre>

<p>This will create a results file in</p>

<pre><code class="language-/home/username/bench_results/summary.png```.">
If you have built ```basho_bench``` from source, you can just use
```make```.  To generate a benchmark graph against the current
results, run:

```bash
make results
</code></pre>

<p>This will create a results file in <code>tests/current/summary.png</code>.</p>

<p>You can also run this manually:</p>

<pre><code class="language-bash">priv/summary.r -i tests/current
</code></pre>

<h3 id="troubleshooting-graph-generation:4e0a3a2ad4748115aedce09826462c7a">Troubleshooting Graph Generation</h3>

<p>For additional help, see the [[Troubleshooting Graph
Generation|<a href="https://github.com/basho/basho_bench#troubleshooting-graph-generation]]">https://github.com/basho/basho_bench#troubleshooting-graph-generation]]</a>
section of the <code>basho_bench/README</code>.</p>

<h2 id="how-does-it-work:4e0a3a2ad4748115aedce09826462c7a">How does it work?</h2>

<p>When Basho Bench starts (<code>basho_bench.erl</code>), it reads the
configuration (<code>basho_bench_config.erl</code>), creates a new results
directory, and then sets up the test (<code>basho_bench_app.erl</code> and
<code>basho_bench_sup.erl</code>).</p>

<p>During test setup, Basho Bench creates the following:</p>

<ul>
<li>One <strong>stats process</strong> (<code>basho_bench_stats.erl</code>). This process
receives notifications when an operation completes, plus the
elapsed time of the operation, and stores it in a histogram. At
regular intervals, the histograms are dumped to <code>summary.csv</code> as
well as operation-specific latency CSVs (e.g. <code>put_latencies.csv</code>
for the PUT operation).</li>
<li>N <strong>workers</strong>, where N is specified by the [[concurrent|Basho
Bench#concurrent]] configuration setting
(<code>basho_bench_worker.erl</code>). The worker process wraps a driver
module, specified by the [[driver|Basho Bench#driver]]
configuration setting. The driver is randomly invoked using the
distribution of operations as specified by the [[operations|Basho
Bench#operations]] configuration setting. The rate at which the
driver invokes operations is governed by the [[mode|Basho
Bench#mode]] setting.</li>
</ul>

<p>Once these processes have been created and initialized, Basho Bench
sends a run command to all worker processes, causing them to begin the
test. Each worker is initialized with a common seed value for random
number generation to ensure that the generated workload is reproducible
at a later date.</p>

<p>During the test, the workers repeatedly call <code>driver:run/4</code>, passing in
the next operation to run, a keygen function, a valuegen function, and
the last state of the driver. The worker process times the operation,
and reports this to the stats process when the operation has completed.</p>

<p>Finally, once the test has been run for the duration specified in the
config file, all workers and stats processes are terminated and the
benchmark ends. The measured latency and throughput of the test can be
found in <code>./tests/current/</code>. Previous results are in timestamped
directories of the form <code>./tests/YYYYMMDD-HHMMSS/</code>.</p>

<h2 id="configuration:4e0a3a2ad4748115aedce09826462c7a">Configuration</h2>

<p>Basho Bench ships with a number of sample configuration files, available
in the <code>/examples</code> directory.</p>

<h3 id="global-config-settings:4e0a3a2ad4748115aedce09826462c7a">Global Config Settings</h3>

<h4 id="mode:4e0a3a2ad4748115aedce09826462c7a">mode</h4>

<p>The <code>mode</code> setting controls the rate at which workers invoke the
<code>{driver:run/4}</code> function with a new operation. There are two possible
values:</p>

<ul>
<li><code>{max}</code> &mdash; generate as many ops per second as possible</li>
<li><code>{rate, N}</code> &mdash; generate N ops per second, with exponentially distributed interarrival times</li>
</ul>

<p>Note that this setting is applied to each driver independently. For
example, if <code>{rate, 5}</code> is used with 3 concurrent workers, Basho Bench
will be generating 15 (i.e. 5 * 3) operations per second.</p>

<pre><code class="language-erlang">% Run at max, i.e.: as quickly as possible
{mode, max}

% Run 15 operations per second per worker
{mode, {rate, 15}}
</code></pre>

<h4 id="concurrent:4e0a3a2ad4748115aedce09826462c7a">concurrent</h4>

<p>The number of concurrent worker processes. The default is 3 worker
processes. This determines the number of concurrent clients running
requests on API under test.</p>

<pre><code class="language-erlang">% Run 10 concurrent processes
{concurrent, 10}
</code></pre>

<h4 id="duration:4e0a3a2ad4748115aedce09826462c7a">duration</h4>

<p>The duration of the test, in minutes. The default is 5 minutes.</p>

<pre><code class="language-erlang">% Run the test for one hour
{duration, 60}
</code></pre>

<h4 id="operations:4e0a3a2ad4748115aedce09826462c7a">operations</h4>

<p>The possible operations that the driver will run, plus their &ldquo;weight,&rdquo;
or likelihood of being run. The default is <code>[{get,4},{put,4},{delete,
1}]</code>, which means that out of every 9 operations, GET will be called
four times, PUT will be called four times, and DELETE will be called
once, on average.</p>

<pre><code class="language-erlang">{operations, [{get, 4}, {put, 1}]}.
</code></pre>

<p>Operations are defined on a <strong>per-driver</strong> basis. Not all drivers will
implement the GET/PUT operations discussed above. Consult the driver
source to determine the valid operations. If you&rsquo;re testing the HTTP
interface, for example, the corresponding operations are GET and
UPDATE, respectively.</p>

<p>If a driver does not support a specified operation (<code>asdfput</code> in this
example), you may see errors like this:</p>

<pre><code class="language-log">DEBUG:Driver basho_bench_driver_null crashed: {function_clause,
                                          [{{{basho_bench_driver_null,run,
                                            [asdfput,
                                             #Fun&lt;basho_bench_keygen.4.4674&gt;,
                                             #Fun&lt;basho_bench_valgen.0.1334&gt;,
                                             undefined]}}},
                                           {{{basho_bench_worker,
                                            worker_next_op,1}}},
                                           {{{basho_bench_worker,
                                            max_worker_run_loop,1}}}]}
</code></pre>

<h4 id="driver:4e0a3a2ad4748115aedce09826462c7a">driver</h4>

<p>The module name of the driver that Basho Bench will use to generate
load. A driver may simply invoke code in-process (such as when
measuring the performance of DETS) or may open network connections and
generate load on a remote system (such as when testing a Riak
server/cluster).</p>

<p>Available drivers include:</p>

<ul>
<li><code>basho_bench_driver_http_raw</code> &mdash; Uses Riak&rsquo;s HTTP interface to
get/update/insert data on a Riak server</li>
<li><code>basho_bench_driver_riakc_pb</code> &mdash; Uses Riak&rsquo;s Protocol Buffers
interface to get/put/update/delete data on a Riak serve</li>
<li><code>basho_bench_driver_riakclient</code> &mdash; Uses Riak&rsquo;s Distributed Erlang
interface to get/put/update/delete data on a Riak server</li>
<li><code>basho_bench_driver_bitcask</code> &mdash; Directly invokes the Bitcask API</li>
<li><code>basho_bench_driver_dets</code> &mdash; Directly invokes the DETS API</li>
</ul>

<p>On invocation of the <code>driver:run/4</code> method, the driver may return one of
the following results:</p>

<ul>
<li><code>{ok, NewState}</code> &mdash; operation completed successfully</li>
<li><code>{error, Reason, NewState}</code> &mdash; operation failed but the driver can
continue processing (i.e. recoverable error)</li>
<li><code>{stop, Reason}</code> &mdash; operation failed; driver can&rsquo;t/won&rsquo;t continue
processing</li>
<li><code>{'EXIT', Reason}</code> &mdash; operation failed; driver crashed</li>
</ul>

<h4 id="code-paths:4e0a3a2ad4748115aedce09826462c7a">code_paths</h4>

<p>Some drivers need additional Erlang code in order to run. Specify the
paths to this code using the <code>code_paths</code> configuration setting.</p>

<h4 id="key-generator:4e0a3a2ad4748115aedce09826462c7a">key_generator</h4>

<p>The generator function to use for creating keys. Generators are defined
in <code>basho_bench_keygen.erl</code>. Available generators include:</p>

<ul>
<li><code>{sequential_int, MaxKey}</code> &mdash; generates integers from 0..<code>MaxKey</code>
in order and then stops the system. Note that each instance of
this keygen is specific to a worker.</li>
<li><code>{partitioned_sequential_int, MaxKey}</code> &mdash; the same as
<code>{sequential_int}</code>, but splits the keyspace evenly among the
worker processes. This is useful for pre-loading a large dataset.</li>
<li><code>{partitioned_sequential_int, StartKey, NumKeys}</code> &mdash; the same as
<code>partitioned_sequential_int</code>, but starting at the defined
<code>StartKey</code> and going up to <code>StartKey + NumKeys</code>.</li>
<li><code>{uniform_int, MaxKey}</code> &mdash; selects an integer from uniform
distribution of 0..<code>MaxKey</code>, i.e. all integers are equally probable.</li>
<li><code>{pareto_int, MaxKey}</code> &mdash; selects an integer from a Pareto
distribution, such that 20% of the available keys get selected 80%
of the time. Note that the current implementation of this
generator <em>may</em> yield values larger than <code>MaxKey</code> due to the
mathematical properties of the Pareto distribution.</li>
<li><code>{truncated_pareto_int, MaxKey}</code> &mdash; the same as <code>{pareto_int}</code>, but
will _not&gt; yield values above <code>MaxKey</code>.</li>
<li><code>{function, Module, Function, Args}</code> &mdash; specifies an external
function that should return a key generator function. The worker
<code>Id</code> will be prepended to <code>Args</code> when the function is called.</li>
<li><code>{int_to_bin, Generator}</code> &mdash; takes any of the above <code>_int</code>
generators and converts the number to a 32-bit binary. This is
needed for some drivers that require a binary key.</li>
<li><code>{int_to_str, Generator}</code> &mdash; takes any of the above <code>_int</code>
generators and converts the number to a string. This is needed for
some drivers that require a string key.</li>
</ul>

<p>The default key generator is <code>{uniform_int, 100000}</code>.</p>

<p>Examples:</p>

<pre><code class="language-erlang">% Use a randomly selected integer between 1 and 10,000
{key_generator, {uniform_int, 10000}}.

% Use a randomly selected integer between 1 and 10,000, as binary.
{key_generator, {int_to_bin, {uniform_int, 10000}}}.

% Use a pareto distributed integer between 1 and 10,000; values &lt; 2000
% will be returned 80% of the time.
{key_generator, {pareto_int, 10000}}.
</code></pre>

<h4 id="value-generator:4e0a3a2ad4748115aedce09826462c7a">value_generator</h4>

<p>The generator function to use for creating values. Generators are
defined in <code>basho_bench_valgen.erl</code>. Available generators include:</p>

<ul>
<li><code>{fixed_bin, Size}</code> &mdash; generates a random binary of <code>Size</code>
bytes. Every binary is the same size, but varies in content.</li>
<li><code>{exponential_bin, MinSize, Mean}</code> &mdash; generates a random binary
which has an exponentially distributed size. Most values will be
approximately <code>MinSize</code> + <code>Mean</code> bytes in size, with a long tail
of larger values.</li>
<li><code>{uniform_bin, MinSize, MaxSize}</code> &mdash; generates a random binary
which has an evenly distributed size between <code>MinSize</code> and
<code>MaxSize</code>.</li>
<li><code>{function, Module, Function, Args}</code> &mdash; specifies an external
function that should return a value generator function. The worker
<code>Id</code> will be prepended to <code>Args</code> when the function is called.</li>
</ul>

<p>The default value generator is <code>{value_generator, {fixed_bin, 100}}</code>.</p>

<p>Examples:</p>

<pre><code class="language-erlang">% Generate a fixed size random binary of 512 bytes
{value_generator, {fixed_bin, 512}}.

% Generate a random binary whose size is exponentially distributed
% starting at 1000 bytes and a mean of 2000 bytes
{value_generator, {exponential_bin, 1000, 2000}}.
</code></pre>

<h4 id="rng-seed:4e0a3a2ad4748115aedce09826462c7a">rng_seed</h4>

<p>The initial random seed to use. This is explicitly seeded, rather than
seeded from the current time, so that a test can be run in a
predictable, repeatable fashion.</p>

<p>Default is <code>{rng_seed, {42, 23, 12}}</code>.</p>

<pre><code class="language-erlang">% Seed to {12, 34, 56}
{rng_seed, {12, 34, 56}.
</code></pre>

<h4 id="log-level:4e0a3a2ad4748115aedce09826462c7a">log_level</h4>

<p>The <code>log_level</code> setting determines which messages Basho Bench will log
to the console and to disk.</p>

<p>The default level is <code>debug</code>.</p>

<table>
<thead>
<tr>
<th align="left">Valid levels</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left"><code>debug</code></td>
</tr>

<tr>
<td align="left"><code>info</code></td>
</tr>

<tr>
<td align="left"><code>warning</code></td>
</tr>

<tr>
<td align="left"><code>error</code></td>
</tr>
</tbody>
</table>

<h4 id="report-interval:4e0a3a2ad4748115aedce09826462c7a">report_interval</h4>

<p>How often, in seconds, the stats process should write histogram data
to disk. The default is 10 seconds.</p>

<h4 id="test-dir:4e0a3a2ad4748115aedce09826462c7a">test_dir</h4>

<p>The directory in which result data is written. The default is <code>/tests</code>.</p>

<h3 id="basho-bench-driver-riakclient-settings:4e0a3a2ad4748115aedce09826462c7a">basho_bench_driver_riakclient Settings</h3>

<p>These configuration settings apply to the
<code>basho_bench_driver_riakclient</code> driver.</p>

<h4 id="riakclient-nodes:4e0a3a2ad4748115aedce09826462c7a">riakclient_nodes</h4>

<p>List of Riak nodes to use for testing.</p>

<pre><code class="language-erlang">{riakclient_nodes, ['riak1@127.0.0.1', 'riak2@127.0.0.1']}.
</code></pre>

<h4 id="riakclient-cookie:4e0a3a2ad4748115aedce09826462c7a">riakclient_cookie</h4>

<p>The Erlang cookie to use to connect to Riak clients. The default is <code>riak</code>.</p>

<pre><code class="language-erlang">{riakclient_cookie, riak}.
</code></pre>

<h4 id="riakclient-mynode:4e0a3a2ad4748115aedce09826462c7a">riakclient_mynode</h4>

<p>The name of the local node. This is passed into
<a href="http://erlang.org/doc/man/net_kernel.html">net_kernel:start/1</a>.</p>

<pre><code class="language-erlang">{riakclient_mynode, ['basho_bench@127.0.0.1', longnames]}.
</code></pre>

<h4 id="riakclient-replies:4e0a3a2ad4748115aedce09826462c7a">riakclient_replies</h4>

<p>This value is used for R-values during a get operation, and W-values
during a put operation.</p>

<pre><code class="language-erlang">% Expect 1 reply.
{riakclient_replies, 1}.
</code></pre>

<h4 id="riakclient-bucket:4e0a3a2ad4748115aedce09826462c7a">riakclient_bucket</h4>

<p>The Riak bucket to use for reading and writing values. The Default is
<code>&lt;&lt;&quot;test&quot;&gt;&gt;</code>.</p>

<pre><code class="language-erlang">% Use the &quot;bench&quot; bucket.
{riakclient_bucket, &lt;&lt;&quot;bench&quot;&gt;&gt;}.
</code></pre>

<h3 id="basho-bench-driver-riakc-pb-settings:4e0a3a2ad4748115aedce09826462c7a">basho_bench_driver_riakc_pb Settings</h3>

<h4 id="riakc-pb-ips:4e0a3a2ad4748115aedce09826462c7a">riakc_pb_ips</h4>

<p>A list of IP addresses to connect the workers to. A random IP will be
chosen for each worker.</p>

<p>The default is <code>{riakc_pb_ips, [{127,0,0,1}]}</code></p>

<pre><code class="language-erlang">% Connect to a cluster of 3 machines
{riakc_pb_ips, [{10,0,0,1},{10,0,0,2},{10,0,0,3}]}
</code></pre>

<h4 id="riakc-pb-port:4e0a3a2ad4748115aedce09826462c7a">riakc_pb_port</h4>

<p>The port on which to connect to the PBC interface.</p>

<p>The default is <code>{riakc_pb_port, 8087}</code></p>

<h4 id="riakc-pb-bucket:4e0a3a2ad4748115aedce09826462c7a">riakc_pb_bucket</h4>

<p>The bucket to use for testing.</p>

<p>The default is <code>{riakc_pb_bucket, &lt;&lt;&quot;test&quot;&gt;&gt;}</code></p>

<h3 id="basho-bench-driver-http-raw-settings:4e0a3a2ad4748115aedce09826462c7a">basho_bench_driver_http_raw Settings</h3>

<h4 id="http-raw-ips:4e0a3a2ad4748115aedce09826462c7a">http_raw_ips</h4>

<p>A list of IP addresses to connect the workers to. Each worker makes
requests to each IP in a round-robin fashion.</p>

<p>The default is <code>{http_raw_ips, [&quot;127.0.0.1&quot;]}</code></p>

<pre><code class="language-erlang">% Connect to a cluster of machines in the 10.x network
{http_raw_ips, [&quot;10.0.0.1&quot;, &quot;10.0.0.2&quot;, &quot;10.0.0.3&quot;]}.
</code></pre>

<h4 id="http-raw-port:4e0a3a2ad4748115aedce09826462c7a">http_raw_port</h4>

<p>Select the default port to connect to for the HTTP server.</p>

<p>The default is <code>{http_raw_port, 8098}</code>.</p>

<pre><code class="language-erlang">% Connect on port 8090
{http_raw_port, 8090}.
</code></pre>

<h4 id="http-raw-path:4e0a3a2ad4748115aedce09826462c7a">http_raw_path</h4>

<p>The base path to use for accessing Riak, usually <code>&quot;/riak/&lt;bucket&gt;&quot;</code>.</p>

<p>The default is <code>{http_raw_path, &quot;/riak/test&quot;}</code>.</p>

<pre><code class="language-erlang">% Place test data in another_bucket
{http_raw_path, &quot;/riak/another_bucket&quot;}.
</code></pre>

<h4 id="http-raw-params:4e0a3a2ad4748115aedce09826462c7a">http_raw_params</h4>

<p>Additional parameters to add to the end of the URL. This can be used
to set the <code>r</code>/<code>w</code>/<code>dw</code>/<code>rw</code> parameters as desired.</p>

<p>The default is <code>{http_raw_params, &quot;&quot;}</code>.</p>

<pre><code class="language-erlang">% Set R=1, W=1 for testing a system with n_val set to 1
{http_raw_params, &quot;?r=1&amp;w=1&quot;}.
</code></pre>

<h4 id="http-raw-disconnect-frequency:4e0a3a2ad4748115aedce09826462c7a">http_raw_disconnect_frequency</h4>

<p>How often, in seconds or number of operations, the HTTP clients
(workers) should forcibly disconnect from the server.</p>

<p>The default is <code>{http_raw_disconnect_frequency, infinity}</code> (which
means that Basho Bench should never forcibly disconnect).</p>

<pre><code class="language-erlang">% Disconnect after 60 seconds
{http_raw_disconnect_frequency, 60}.

% Disconnect after 200 operations
{http_raw_disconnect_frequency, {ops, 200}}.
</code></pre>

<h2 id="custom-driver:4e0a3a2ad4748115aedce09826462c7a">Custom Driver</h2>

<p>A custom driver must expose the following callbacks.</p>

<pre><code class="language-erlang">% Create the worker
% ID is an integer
new(ID) -&gt; {ok, State} or {error, Reason}.

% Run an operation
run(Op, KeyGen, ValueGen, State) -&gt; {ok, NewState} or {error, Reason, NewState}.
</code></pre>

<p>See the <a href="https://github.com/basho/basho_bench/tree/master/src">existing
drivers</a> for
more details.</p>


      <div class="clear"></div>

    </article>

    <footer class="mastfooter">
    This work is licensed under a
    <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 International Public License
    </a><br>
    &copy; 2011-2016&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
</footer>


  </div>

  <script src="/js/all.js" type="text/javascript"></script>
<script type= "text/javascript">
  
  hljs.configure({languages: []});
  hljs.initHighlighting();

  
  
  
  $(function() {
    $(".js_enabled pre").css("visibility", "visible");
  });
</script>


</body>
</html>
