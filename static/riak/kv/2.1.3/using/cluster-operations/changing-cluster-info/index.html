<!DOCTYPE html>

<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"></html><![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8" lang="en"></html><![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"></html><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->




<head class="tutorials">
  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <meta name="project" content="riak_kv">
  <meta name="version" content="2.1.3">
  <meta name="base-url" content="">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <title>Changing Cluster Information</title>

  <link href="/css/all.css" media="screen" rel="stylesheet" type="text/css">
  <link href="/css/print.css" media="print" rel="stylesheet" type="text/css">

  
  <style type="text/css"> .js_enabled pre { visibility : hidden; } </style>
  <script type="text/javascript">
    document.documentElement.className = 'js_enabled';
  </script>
</head>



<body class="riak_kv 2.1.3 latest ">

  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>

  
<aside id="nav-container" role="complementary">
  <nav class="overview" id="primary-nav" role="nav">
    <div id="primary-nav-content">
      <h2 class="responsive-link"><a class="responsive-toggle"></a></h2>

      
      <form id="searchbox_011972015458788978446:zgdcy4fa-o0" action="">
        <div class="nav-field-container">
          <div id="icon-container-search">
            <div class="icon-container"><span aria-hidden="true" class="nav-icon-search icon-search"></span></div>
            <span class="separator">&#124;</span>
          </div>
          <input id="main-search" name="q" placeholder="Search" size="5" type="search" />
        </div>
      </form>

      <div class="clear"></div>

      
      <h3 class="responsive-link visit-basho">
        <a href="http://www.basho.com">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">Visit Basho</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      <h3 class="responsive-link">
        <a href="/index.html">
          <div class="icon-container">
            <span aria-hidden="true" class="nav-icon" data-icon="&#xe003;"></span>
          </div>
          <span class="separator">&#124;</span>
          <span class="menu-title">All Riak Projects</span>
          <div class="clear"></div>
        </a>
      </h3>

      
      
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-riak"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/">Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-download-alt"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/downloads/">Download Riak KV</a></span>
        <div class="clear"></div>
      </h3>
      
       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-install"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/setup/">Setup</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/">Planning</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/start/">Start Planning</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/operating-system/">OS Support</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/planning/backend/">Choosing a Backend</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/bitcask/">Bitcask</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/leveldb/">LevelDB</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/memory/">Memory</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/backend/multi/">Multi-backend</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/cluster-capacity/">Cluster Capacity</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/bitcask-capacity-calc/">Bitcask Capacity Calculator</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/planning/future/">Planning for the Future</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/">Installing</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/amazon-web-services/">Amazon Web Services</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/debian-ubuntu/">Debian &amp; Ubuntu</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/freebsd/">FreeBSD</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/mac-osx/">Mac OS X</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/rhel-centos/">RHEL &amp; CentOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/smartos/">SmartOS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/solaris/">Solaris</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/suse/">SUSE</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/windows-azure/">Windows Azure</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/installing/source/">Installing From Source</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/erlang/">Installing Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/source/jvm/">Installing the JVM</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/installing/verify/">Verifying an Installation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/setup/upgrading/">Upgrading</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/checklist/">Production Checklist</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/version/">Upgrading by Version</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/cluster/">Upgrading a Cluster</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/multi-datacenter/">Upgrading Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/setup/upgrading/downgrade/">Downgrading</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-cog"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/configuring/">Configuring</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/basic/">Basic Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/backend/">Backend Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/managing/">Managing Configuration</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/reference/">Configuration Reference</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/strong-consistency/">Implementing Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/load-balancing-proxy/">Load Balancing &amp; Proxy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/mapreduce/">MapReduce Settings</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/search/">Search Settings</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/">V3 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v3-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/">V2 Multi-Datacenter</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/quick-start/">Quickstart</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/nat/">With NAT</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/configuring/v2-multi-datacenter/ssl/">SSL</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-database"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/using/">Using</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/running-a-cluster/">Running a Cluster</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/admin/">Cluster Administration</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/commands/">Cluster Admin Commands</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-admin/">riak-admin CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-cli/">riak CLI</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/admin/riak-control/">Riak Control</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/cluster-operations/">Cluster Operations</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/adding-removing-nodes/">Adding/Removing Nodes</a>
  
  </li>
  <li class="current">
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/changing-cluster-info/">Changing Cluster Information</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/replacing-node/">Replacing a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/inspecting-node/">Inspecting a Node</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backing-up/">Backing Up</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/secondary-indexes/">Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/monitoring-strong-consistency/">Monitoring Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/load-balancing/">Load Balancing</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/backend/">Backend</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v3-multi-datacenter/">V3 Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/cluster-operations/v2-multi-datacenter/">V2 Multi-Datacenter</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/repair-recovery/">Repair &amp; Recovery</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/errors/">Errors</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/repairs/">Repairs</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/repair-recovery/rolling-restart/">Rolling Restarts</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/security/">Security</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/basics/">Security Basics</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/managing-sources/">Managing Security Sources</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/best-practices/">Best Practices</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/security/v2-v3-ssl-ca/">V2/V3 SSL &amp; CA Validation</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/performance/">Performance</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/benchmarking/">Benchmarking</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/open-files-limit/">Open Files Limit</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/v2-scheduling-fullsync/">V2 Scheduling Fullsync</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/performance/multi-datacenter-tuning/">Multi-Datacenter Replication</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/">Troubleshooting</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/">Product Advisories</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/210-dataloss/">Default Configuration For Handoff May Cause Data Loss</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/appconfig-foward/">Forward Incompatibility of app.config</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/dvv-lastwritewins/">Incompatibility between Dotted Version Vectors and Last Write Wins</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/maps-204/">Map Data Type Disk Incompatibility</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/product-advisories/ssl-poodle/">SSL 3.0 Vulnerability and POODLE Attack</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/troubleshooting/http-204/">HTTP 204</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/using/reference/">Reference</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/logging/">Logging</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/handoff/">Handoff</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/object-deletion/">Object Deletion</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/runtime-interaction/">Runtime Interaction</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/failure-recovery/">Failure &amp; Recovery</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/monitoring/">Monitoring</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/search-secondary-indexes/">Search &amp; Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/multi-datacenter/">Multi-Datacenter</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v3/">V3 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/v2/">V2 Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/using/reference/architecture/">Architecture</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-lambda"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/developing/">Developing</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/">Getting Started</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/java/">Java</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/java/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/ruby/">Ruby</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/ruby/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/python/">Python</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/python/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/csharp/">C Sharp</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/csharp/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/nodejs/">NodeJS</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/nodejs/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/erlang/">Erlang</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/erlang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/golang/">Go</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/querying/">Querying</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/golang/object-modeling/">Object Modeling</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/getting-started/php/">PHP</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/crud-operations/">CRUD Operations</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/getting-started/php/querying/">Querying</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/">Usage</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/creating-objects/">Creating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/reading-objects/">Reading Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/updating-objects/">Updating Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/deleting-objects/">Deleting Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/content-types/">Content Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search/">Searching</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/mapreduce/">Using MapReduce</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/secondary-indexes/">Using Secondary Indexes</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/bucket-types/">Bucket Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/commit-hooks/">Using Commit Hooks</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/search-schemas/">Creating Search Schemas</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/searching-data-types/">Searching with Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/document-store/">Implementing a Document Store</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/custom-extractors/">Custom Extractors</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/security/">Security</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/erlang/">Erlang</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/security/php/">PHP</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/replication/">Replication</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/">Conflict Resolution</a></span></h4>
    
<ul class="depth-3">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/java/">Java</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/ruby/">Ruby</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/python/">Python</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/csharp/">C Sharp</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/nodejs/">NodeJS</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/php/">PHP</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/usage/conflict-resolution/golang/">Go</a>
  
  </li></ul>

  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-types/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/data-modeling/">Data Modeling</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/app-guide/">Application Guide</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/replication-properties/">Replication Properties</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/strong-consistency/">Strong Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/write-once/">Write Once</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/app-guide/reference/">Reference</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/client-libraries/">Client Libraries</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/developing/api/">APIs</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/repl-hooks/">V2 Multi-Datacenter REPL Hooks API</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/api/backend/">Backend API</a>
  
  </li></ul>

  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/developing/faq/">Developing FAQ</a>
  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-beaker"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/riak/kv/2.1.3/learn/">Learning</a></span>
        <div class="clear"></div>
      </h3>
      
      
        
<ul class="depth-1">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/why-riak-kv/">Why Riak KV?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/use-cases/">Use Cases</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/new-to-nosql/">New to NoSQL?</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/glossary/">Riak KV Glossary</a>
  
  </li>
  <li >
  
    <h4><span><a href="/riak/kv/2.1.3/learn/concepts/">Concepts</a></span></h4>
    
<ul class="depth-2">
  
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/active-anti-entropy/">Active Anti-Entropy</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/buckets/">Buckets</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/capability-negotiation/">Capability Negotiation</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/causal-context/">Causal Context</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/clusters/">Clusters</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/crdts/">Data Types</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/eventual-consistency/">Eventual Consistency</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/keys-and-objects/">Keys and Objects</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/replication/">Replication</a>
  
  </li>
  <li >
  
    <a href="/riak/kv/2.1.3/learn/concepts/vnodes/">Vnodes</a>
  
  </li></ul>

  
  </li></ul>

       
      <h3>
        <div class="icon-container"><span aria-hidden="true" class="nav-icon icon-comments"></span>&nbsp;</div>
        <span class="separator">&#124;</span>
        <span class="menu-title"><a href="/community">Community</a></span>
        <div class="clear"></div>
      </h3>
      <ul></ul> 
    </div>
  </nav>

  
  <ul id="fixed-nav">
    <li>
      <a href="https://github.com/basho/basho_docs" target="_blank">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xe004;"></span>
        </div>
        <span class="separator">&#124;</span>Available on GitHub
      </a>
    </li>
    <li>
      <a href="/riak/latest/community/">
        <div class="icon-container">
          <span aria-hidden="true" class="nav-icon" data-icon="&#xf059;"></span>
        </div>
        <span class="separator">&#124;</span>Get Help
      </a>
    </li>
  </ul>
</aside>


  <script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>


  <div role="main">

    <header class="masthead">
  <div id="header">
    
    <div id="header-inner">
      <div class="icon-reorder" id="nav-toggle"></div>

      <div id="top-nav">
        
        <a href="/riak/kv/2.1.3/downloads/"><span class="icon-download-alt"></span>Downloads</a>
        <div id="nav-more"><span class="icon-more"></span></div>
      </div>

      <a class="responsive-toggle"></a>
      
      
      <a class="logo" href="/index.html"><h1>Riak Docs</h1></a>
      
      <span class="tagline">Product tutorials, how-tos, and fully-documented APIs.</span>
      <div id="nav-menu">
        <h2>Links</h2>
        <ul>
          <li><a href="http://docs.basho.com/">Docs Home</a></li>
          <li><a href="http://basho.com/">Basho Website</a></li>
        </ul>
        
        <div id="nav-menu-arrow"></div>
        <div id="nav-menu-arrow-back"></div>
      </div>

      <div class="clear"></div>

      <div class="header-rule"></div>
    </div>
  </div>
</header>


    <article class="mainarticle">

      <div class="versions">
  <div id="version-ddown-button" class="unselected">
    <div class="version-ddown-title">Version</div>
    <div class="version-ddown-number">2.1.3</div>
    <div class="version-ddown-arrow"></div>
  </div>
  <ol id="version-list" style="display: none;">
  
  
    
    
      
      
      <li class="sans versions-0 current">DEV</li>
      
      <li class="current versions-0"><a class="versioned" href="/riak/kv/2.1.3/using/cluster-operations/changing-cluster-info/">2.1.3</a></li>
    
    
      
      
      
      <li class=" versions-0 first"><a class="versioned" href="/riak/kv/2.1.1/using/cluster-operations/changing-cluster-info/">2.1.1</a></li>
    
  
    
    
      
      
      
      <li class="sans versions-1 current">LTS</li>
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.6/using/cluster-operations/changing-cluster-info/">2.0.6</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.5/using/cluster-operations/changing-cluster-info/">2.0.5</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.4/using/cluster-operations/changing-cluster-info/">2.0.4</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.2/using/cluster-operations/changing-cluster-info/">2.0.2</a></li>
    
      
      
      
      
      <li class=" versions-1"><a class="versioned" href="/riak/kv/2.0.1/using/cluster-operations/changing-cluster-info/">2.0.1</a></li>
    
    
      
      
      
      <li class=" versions-1 first"><a class="versioned" href="/riak/kv/2.0.0/using/cluster-operations/changing-cluster-info/">2.0.0</a></li>
    
  
  
  <li class="versions-5 first"><a class="sans versioned" href="http://docs.basho.com/riak/1.4.12/">older</a></li>
  </ol>
</div>


      
      

      <header><h1>Changing Cluster Information</h1></header>

      

      
      <nav id="toc">
        <h2 class="title">Contents</h2>
        <div id="toc-wrapper">
          <ol id="toc-items"></ol>
        </div>
      </nav>
      

      

<h2 id="change-the-node-name:708ea29fcdaf06d029c670e48160127e">Change the Node Name</h2>

<p>The node name is an important setting for the Erlang VM, especially when
you want to build a cluster of nodes, as the node name identifies both
the Erlang application and the host name on the network. All nodes in
the Riak cluster need these node names to communicate and coordinate
with each other.</p>

<p>In your configuration files, the node name defaults to <code>riak@127.0.0.1</code>.
To change the node name, change the following line:</p>

<pre><code class="language-riakconf">nodename = riak@127.0.0.1
</code></pre>

<pre><code class="language-vmargs">-name riak@127.0.0.1
</code></pre>

<p>Change it to something that corresponds to either the IP address or a
resolvable host name for this particular node, like so:</p>

<pre><code class="language-riakconf">nodename = riak@192.168.1.10
</code></pre>

<pre><code class="language-vmargs">-name riak@192.168.1.10
</code></pre>

<h2 id="change-the-http-and-protocol-buffers-binding-address:708ea29fcdaf06d029c670e48160127e">Change the HTTP and Protocol Buffers binding address</h2>

<p>By default, Riak&rsquo;s HTTP and Protocol Buffers services are bound to the
local interface, i.e. 127.0.0.1, and are therefore unable to serve
requests from the outside network. The relevant setting is in your
<a href="/riak/kv/2.1.3/configuring/reference">configuration files</a>:</p>

<pre><code class="language-riakconf"># For HTTP
listener.http.internal = 127.0.0.1:8098

# For Protocol Buffers
listener.protobuf.internal = 127.0.0.1:8087
</code></pre>

<pre><code class="language-appconfig">% In the riak_api section

% For HTTP
{http, [ {&quot;127.0.0.1&quot;, 8098 } ]},

% For Protocol Buffers
{pb, [ {&quot;127.0.0.1&quot;, 8087} ] },
</code></pre>

<p>Either change it to use an IP address that corresponds to one of the
server&rsquo;s network interfaces, or 0.0.0.0 to allow access from all
interfaces and networks, e.g.:</p>

<pre><code class="language-riakconf">listener.http.internal = 0.0.0.0:8098
</code></pre>

<pre><code class="language-appconfig">% In the riak_core section
{http, [ {&quot;0.0.0.0&quot;, 8098 } ]},
</code></pre>

<p>The same configuration should be changed for the Protocol Buffers
interface if you intend on using it (which we recommend). Change the
following line:</p>

<pre><code class="language-riakconf">listener.protobuf.internal = 0.0.0.0&quot;:8087
</code></pre>

<pre><code class="language-appconfig">% In the riak_core section
{pb, [ {&quot;0.0.0.0&quot;, 8087} ] },
</code></pre>

<h2 id="rename-single-node-clusters:708ea29fcdaf06d029c670e48160127e">Rename Single Node Clusters</h2>

<p>To rename a single-node development cluster:</p>

<ol>
<li><p>Stop the node with <code>riak stop</code>.</p></li>

<li><p>Change the node&rsquo;s <code>nodename</code> parameter in <code>riak.conf</code>, or <code>-name</code> parameter in <code>vm.args</code> to the new name.</p></li>

<li><p>Change any IP addresses in <code>riak.conf</code> or <code>app.config</code> if necessary. Specifically: <code>listener.protobuf.$name</code>, <code>listener.http.$name</code>, and <code>listener.https.$name</code> in <code>riak.conf</code>, and <code>pb_ip</code>, <code>http</code>, <code>https</code>, and <code>cluster_mgr</code> in <code>app.config</code>.</p></li>

<li><p>Delete the contents of the node&rsquo;s <code>ring</code> directory. The location of the ring directory is the value for the <code>ring.state_dir</code> in <code>riak.conf</code>, or <code>ring_state_dir</code> in <code>app.config</code>.</p></li>

<li><p>Start Riak on the node with <code>riak start</code>.</p></li>
</ol>

<h2 id="rename-multi-node-clusters:708ea29fcdaf06d029c670e48160127e">Rename Multi-Node Clusters</h2>

<p>For multi-node clusters, a rename is a slightly more complex procedure; however, it is very similar to the process for renaming a single node.</p>

<p>Previous to Riak version 1.2, a cluster node&rsquo;s name could only be changed with the <code>[[riak-admin reip|riak-admin Command Line#reip]]</code> command, which involves downtime for the entire cluster. As of Riak version 1.2, that method has been superseded by <code>[[riak-admin cluster force-replace|riak-admin Command Line#cluster-force-replace]]</code>, which is safer and does not require cluster wide downtime.</p>

<p>There still exist scenarios that require nodes to be renamed while stopped, such as seeding a cluster with backups from another cluster that does not share the same node names. Please see the [[Clusters from Backups|Renaming Nodes#Clusters-From-Backups]] section for more details on renaming in this scenario.</p>

<p>The following example describes reconfiguring node names with the new <code>riak-admin cluster force-replace</code> method.</p>

<h3 id="example-scenario:708ea29fcdaf06d029c670e48160127e">Example Scenario</h3>

<p>For this example scenario, Riak is operating in a cluster of 5 nodes with the following network configuration:</p>

<ul>
<li><code>riak@10.1.42.11</code> on <code>node1.localdomain</code> &rarr; IP address changing to 192.168.17.11</li>
<li><code>riak@10.1.42.12</code> on <code>node2.localdomain</code> &rarr; IP address changing to 192.168.17.12</li>
<li><code>riak@10.1.42.13</code> on <code>node3.localdomain</code> &rarr; IP address changing to 192.168.17.13</li>
<li><code>riak@10.1.42.14</code> on <code>node4.localdomain</code> &rarr; IP address changing to 192.168.17.14</li>
<li><code>riak@10.1.42.15</code> on <code>node5.localdomain</code> &rarr; IP address changing to 192.168.17.15</li>
</ul>

<p>The above list shows the network configuration details for our 5 nodes, including the Erlang node name value, the node&rsquo;s fully qualified domain name, and the new IP address each node will be configured to use.</p>

<p>The nodes in our example cluster are currently configured to use the <em>10.1.42.</em> private subnetwork range. Our goal for this example will be to configure the nodes to instead use the  <em>192.168.17.</em> private subnetwork range and do so in a rolling fashion without interrupting cluster operation.</p>

<h3 id="process:708ea29fcdaf06d029c670e48160127e">Process</h3>

<p>This process can be accomplished in three phases. The details and steps required of each phase are presented in the following section.</p>

<ol>
<li>[[Down the node to be reconfigured|Renaming-Nodes#down]]</li>
<li>[[Reconfigure node to use new address|Renaming-Nodes#reconfigure]]</li>
<li>[[Repeat previous steps on each node|Renaming-Nodes#repeat]]</li>
</ol>

<p><a id="down"></a></p>

<h4 id="down-the-node:708ea29fcdaf06d029c670e48160127e">Down the Node</h4>

<ol>
<li><p>Stop Riak on <code>node1.localdomain</code>:</p>

<pre><code class="language-bash">riak stop
</code></pre>

<p>The output should look like this:</p>

<pre><code>Attempting to restart script through sudo -H -u riak
ok
</code></pre></li>

<li><p>From the <code>node2.localdomain</code> node, mark <code>riak@10.1.42.11</code> down:</p>

<pre><code class="language-bash">riak-admin down riak@10.1.42.11
</code></pre>

<p>Successfully marking the node down should produce output like this:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
Success: &quot;riak@10.1.42.11&quot; marked as down
</code></pre>

<p>This step informs the cluster that <code>riak@10.1.42.11</code> is offline and ring-state transitions should be allowed. While we&rsquo;re executing the <code>riak-admin down</code> command from <code>node2.localdomain</code> in this example, the command can be executed from any currently running node.</p></li>
</ol>

<p><a id="reconfigure"></a></p>

<h4 id="reconfigure-node-to-use-new-address:708ea29fcdaf06d029c670e48160127e">Reconfigure Node to Use New Address</h4>

<p>Reconfigure <code>node1.localdomain</code> to listen on the new private IP address <em>192.168.17.11</em> by following these steps:</p>

<ol>
<li><p>Change the node&rsquo;s <code>nodename</code> parameter in <code>riak.conf</code>, or <code>-name</code> parameter in <code>vm.args</code>, to reflect the new node name. For example:</p>

<p><code>riak.conf</code>: <code>nodename = riak@192.168.17.11</code><br />
<code>vm.args</code> : <code>-name riak@192.168.17.11</code></p></li>

<li><p>Change any IP addresses to <em>192.168.17.11</em> in <code>riak.conf</code> or <code>app.config</code> as previously described in step 3 of [[Single Node Clusters|Renaming Nodes#Single-Node-Clusters]].</p></li>

<li><p>Rename the node&rsquo;s <code>ring</code> directory, the location of which is described in step 4 of [[Single Node Clusters|Renaming Nodes#Single-Node-Clusters]].  You may rename it to whatever you like, as it will only be used as a backup during the node renaming process.</p></li>

<li><p>Start Riak on <code>node1.localdomain</code>.</p>

<pre><code class="language-bash">riak start
</code></pre></li>

<li><p>Join the node back into the cluster.</p>

<pre><code class="language-bash">riak-admin cluster join riak@10.1.42.12
</code></pre>

<p>Successful staging of the join request should have output like this:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
Success: staged join request for 'riak@192.168.17.11' to 'riak@10.1.42.12'
</code></pre></li>

<li><p>Use <code>riak-admin cluster force-replace</code> to change all ownership references from <code>riak@10.1.42.11</code> to <code>riak@192.168.17.11</code>:</p>

<pre><code class="language-bash">riak-admin cluster force-replace riak@10.1.42.11 riak@192.168.17.11
</code></pre>

<p>Successful force replacement staging output looks like this:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
Success: staged forced replacement of 'riak@10.1.42.11' with 'riak@192.168.17.11'
</code></pre></li>

<li><p>Review the new changes with <code>riak-admin cluster plan:</code></p>

<pre><code class="language-bash">riak-admin cluster plan
</code></pre>

<p>Example output:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
=========================== Staged Changes ============================
Action         Nodes(s)
-----------------------------------------------------------------------
join           'riak@192.168.17.11'
force-replace  'riak@10.1.42.11' with 'riak@192.168.17.11'
-----------------------------------------------------------------------


WARNING: All of 'riak@10.1.42.11' replicas will be lost


NOTE: Applying these changes will result in 1 cluster transition


#######################################################################
                     After cluster transition 1/1
#######################################################################


============================= Membership ==============================
Status     Ring    Pending    Node
-----------------------------------------------------------------------
valid      20.3%      --      'riak@192.168.17.11'
valid      20.3%      --      'riak@10.1.42.12'
valid      20.3%      --      'riak@10.1.42.13'
valid      20.3%      --      'riak@10.1.42.14'
valid      18.8%      --      'riak@10.1.42.15'
-----------------------------------------------------------------------
Valid:5 / Leaving:0 / Exiting:0 / Joining:0 / Down:0


Partitions reassigned from cluster changes: 13
13 reassigned from 'riak@10.1.42.11' to 'riak@192.168.17.11'
</code></pre></li>

<li><p>Commit the new changes to the cluster with <code>riak-admin cluster commit</code>:</p>

<pre><code class="language-bash">riak-admin cluster commit
</code></pre>

<p>Output from the command should resemble this example:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
Cluster changes committed
</code></pre></li>

<li><p>Check that the node is participating in the cluster and functioning as expected:</p>

<pre><code class="language-bash">riak-admin member-status
</code></pre>

<p>Output should resemble this example:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
============================= Membership ==============================
Status     Ring    Pending    Node
-----------------------------------------------------------------------
valid      20.3%      --      'riak@192.168.17.11'
valid      20.3%      --      'riak@10.1.42.12'
valid      20.3%      --      'riak@10.1.42.13'
valid      20.3%      --      'riak@10.1.42.14'
valid      18.8%      --      'riak@10.1.42.15'
-----------------------------------------------------------------------
Valid:5 / Leaving:0 / Exiting:0 / Joining:0 / Down:0
</code></pre></li>

<li><p>Monitor hinted handoff transfers to ensure they have finished with the <code>riak-admin transfers</code> command.</p></li>

<li><p>Clean up by deleting the renamed <code>ring</code> directory once all previous steps have been successfully completed.</p></li>
</ol>

<div class="note"><div class="title">Note</div>
When using the `riak-admin force-replace` command, you will always get a warning message like: `WARNING: All of 'riak@10.1.42.11' replicas will be lost`. Since we didn't delete any data files and we are replacing the node with itself under a new name, we will not lose any replicas.
</div>

<p><a id="repeat"></a></p>

<h4 id="repeat-previous-steps-on-each-node:708ea29fcdaf06d029c670e48160127e">Repeat previous steps on each node</h4>

<p>Repeat the steps above for each of the remaining nodes in the cluster.</p>

<p>Use <em>riak@192.168.17.11</em> as the target node for further <code>riak-admin cluster join</code> commands issued from subsequently reconfigured nodes to join those nodes to the cluster.</p>

<pre><code class="language-bash">riak-admin cluster join riak@192.168.17.11
</code></pre>

<p>A successful join request staging produces output similar to this example:</p>

<pre><code class="language-bash">Attempting to restart script through sudo -H -u riak
Success: staged join request for 'riak@192.168.17.12' to 'riak@192.168.17.11'
</code></pre>

<h2 id="clusters-from-backups:708ea29fcdaf06d029c670e48160127e">Clusters from Backups</h2>

<p>The above steps describe a process for renaming nodes in a running cluster. When seeding a new cluster with backups where the nodes must have new names, typically done as a secondary cluster or in a disaster recovery scenario, a slightly different process must be used. This is because the node names must resolve to the new hosts in order for the nodes to start and communicate with each other.</p>

<p>Expanding on the Example Scenario above, the below steps can be used to rename nodes in a cluster that is being restored from backups. The below steps assume every node is offline, and they will indicate when to bring each node online.</p>

<h4 id="bringing-up-the-first-node:708ea29fcdaf06d029c670e48160127e">Bringing Up the First Node</h4>

<p>In order to bring our first node online, we&rsquo;ll first need to use the <code>riak-admin reip</code> command on a single node. In this example, we&rsquo;ll use <code>riak@10.1.42.11</code> as our first node.</p>

<ol>
<li><p>In <code>riak.conf</code> change <code>nodename</code>, <code>-name</code> in <code>vm.args</code>, from <code>riak@10.1.42.11</code> to your new nodename, <code>riak@192.168.17.11</code>.</p></li>

<li><p>On <code>node1.localdomain</code> run <code>riak-admin reip riak@10.1.42.11 riak@192.168.17.11</code>. This will change the name of <code>riak@10.1.42.11</code> to <code>riak@192.168.17.11</code> in the Riak ring.</p></li>

<li><p>Start Riak on <code>node1.localdomain</code>.</p></li>

<li><p>Once Riak is started on <code>node1.localdomain</code>, mark the rest of the nodes in the cluster down, using <code>riak-admin down</code>. For example, we would down <code>riak@10.1.42.12</code> with <code>riak-admin down riak@10.1.42.12</code>.</p></li>

<li><p>Confirm every other node in the cluster is marked down by running <code>riak-admin member-status</code> on <code>node1.localdomain</code>:</p>

<pre><code class="language-bash">================================= Membership ==================================
Status     Ring        Pending    Node
-------------------------------------------------------------------------------
valid       20.3%      --      'riak@192.168.17.11'
down        20.3%      --      'riak@10.1.42.12'
down        20.3%      --      'riak@10.1.42.13'
down        20.3%      --      'riak@10.1.42.14'
down        18.8%      --      'riak@10.1.42.15'
-------------------------------------------------------------------------------
Valid:1 / Leaving:0 / Exiting:0 / Joining:0 / Down:4


</code></pre></li>

<li><p>Ensure <code>riak@192.168.17.11</code> is listed as the claimant by running <code>riak-admin ring-status</code> on <code>node1.localdomain</code>:</p>

<pre><code class="language-bash">================================== Claimant ===================================
Claimant:  'riak@192.168.17.11'
Status:     up
Ring Ready: true


============================== Ownership Handoff ==============================
No pending changes.


============================== Unreachable Nodes ==============================
All nodes are up and reachable
</code></pre></li>
</ol>

<p>Once all nodes are marked as down and our first node is listed as the claimant, we can proceed with the rest of the nodes.</p>

<h4 id="bringing-up-the-remaining-nodes:708ea29fcdaf06d029c670e48160127e">Bringing Up the Remaining Nodes</h4>

<ol>
<li><p>On each of the remaining nodes, change <code>nodename</code> in <code>riak.conf</code>, or <code>-name</code> in <code>vm.args</code> as described above.</p></li>

<li><p>Move aside the ring directory. As in [[Multi-Node Clusters|Renaming Nodes#Multi-Node-Clusters]], we will save this ring directory as a backup until were finished.</p></li>

<li><p>Start each node. They will start as if they are each a member of their own cluster, but will retain their restored data.</p></li>

<li><p>Join each node to our first node using <code>riak-admin cluster join riak@192.168.17.11</code>.</p></li>

<li><p>Force replace each node with its old node name. For example, <code>riak-admin cluster force-replace riak@10.1.42.12 riak@192.168.17.12</code>.</p></li>

<li><p>Once the above is complete for each node, run <code>riak-admin cluster plan</code> on any node. The output should look similar to below:</p>

<pre><code class="language-bash">=============================== Staged Changes ================================
Action         Details(s)
-------------------------------------------------------------------------------
force-replace  'riak@10.1.42.12' with 'riak@192.168.17.12'
force-replace  'riak@10.1.42.13' with 'riak@192.168.17.13'
force-replace  'riak@10.1.42.14' with 'riak@192.168.17.14'
force-replace  'riak@10.1.42.15' with 'riak@192.168.17.15'
join           'riak@192.168.17.12'
join           'riak@192.168.17.13'
join           'riak@192.168.17.14'
join           'riak@192.168.17.15'
-------------------------------------------------------------------------------


WARNING: All of 'riak@10.1.42.12' replicas will be lost
WARNING: All of 'riak@10.1.42.13' replicas will be lost
WARNING: All of 'riak@10.1.42.14' replicas will be lost
WARNING: All of 'riak@10.1.42.15' replicas will be lost


NOTE: Applying these changes will result in 1 cluster transition


###############################################################################
                         After cluster transition 1/1
###############################################################################


================================= Membership ==================================
Status     Ring    Pending    Node
-------------------------------------------------------------------------------
valid       20.3%      --      'riak@192.168.17.11'
valid       20.3%      --      'riak@192.168.17.12'
valid       20.3%      --      'riak@192.168.17.13'
valid       20.3%      --      'riak@192.168.17.14'
valid       18.8%      --      'riak@192.168.17.15'
-------------------------------------------------------------------------------
Valid:5 / Leaving:0 / Exiting:0 / Joining:0 / Down:0


Partitions reassigned from cluster changes: 51
  13 reassigned from 'riak@10.1.42.12' to 'riak@192.168.17.12'
  13 reassigned from 'riak@10.1.42.13' to 'riak@192.168.17.13'
  13 reassigned from 'riak@10.1.42.14' to 'riak@192.168.17.14'
  12 reassigned from 'riak@10.1.42.15' to 'riak@192.168.17.15'
</code></pre></li>

<li><p>If the above plan looks correct, commit the cluster changes with <code>riak-admin cluster commit</code>.</p></li>

<li><p>Once the cluster transition has completed, all node names should be changed and be marked as valid in <code>riak-admin member-status</code> like below:</p>

<pre><code class="language-bash">================================= Membership ==================================
Status       Ring       Pending    Node
-------------------------------------------------------------------------------
valid        20.3%      --        'riak@192.168.17.11'
valid        20.3%      --        'riak@192.168.17.12'
valid        20.3%      --        'riak@192.168.17.13'
valid        20.3%      --        'riak@192.168.17.14'
valid        18.8%      --        'riak@192.168.17.15'
-------------------------------------------------------------------------------
Valid:5 / Leaving:0 / Exiting:0 / Joining:0 / Down:0


</code></pre></li>
</ol>


      <div class="clear"></div>

    </article>

    <footer class="mastfooter">
    This work is licensed under a
    <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 International Public License
    </a><br>
    &copy; 2011-2016&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
</footer>


  </div>

  <script src="/js/all.js" type="text/javascript"></script>
<script type= "text/javascript">
  
  hljs.configure({languages: []});
  hljs.initHighlighting();

  
  
  
  $(function() {
    $(".js_enabled pre").css("visibility", "visible");
  });
</script>


</body>
</html>
